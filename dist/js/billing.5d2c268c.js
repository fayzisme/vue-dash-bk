(window.webpackJsonp=window.webpackJsonp||[]).push([["billing"],{"28a5":function(t,e,a){"use strict";var u=a("aae3e"),v=a("cb7c"),x=a("ebd6"),b=a("0390"),_=a("9def"),y=a("5f1b"),m=a("520a"),l=a("79e5"),w=Math.min,p=[].push,o="split",M="length",S="lastIndex",Y=4294967295,C=!l(function(){RegExp(Y,"y")});a("214f")("split",2,function(r,i,g,h){var f="c"=="abbc"[o](/(b)*/)[1]||4!="test"[o](/(?:)/,-1)[M]||2!="ab"[o](/(?:ab)*/)[M]||4!="."[o](/(.?)(.?)/)[M]||1<"."[o](/()()/)[M]||""[o](/.?/)[M]?function(t,e){var a=String(this);if(void 0===t&&0===e)return[];if(!u(t))return g.call(a,t,e);for(var l,r,i,o=[],n=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),s=0,c=void 0===e?Y:e>>>0,d=new RegExp(t.source,n+"g");(l=m.call(d,a))&&!(s<(r=d[S])&&(o.push(a.slice(s,l.index)),1<l[M]&&l.index<a[M]&&p.apply(o,l.slice(1)),i=l[0][M],s=r,o[M]>=c));)d[S]===l.index&&d[S]++;return s===a[M]?!i&&d.test("")||o.push(""):o.push(a.slice(s)),o[M]>c?o.slice(0,c):o}:"0"[o](void 0,0)[M]?function(t,e){return void 0===t&&0===e?[]:g.call(this,t,e)}:g;return[function(t,e){var a=r(this),l=null==t?void 0:t[i];return void 0!==l?l.call(t,a,e):f.call(String(a),t,e)},function(t,e){var a=h(f,t,this,e,f!==g);if(a.done)return a.value;var l=v(t),r=String(this),a=x(l,RegExp),i=l.unicode,t=(l.ignoreCase?"i":"")+(l.multiline?"m":"")+(l.unicode?"u":"")+(C?"y":"g"),o=new a(C?l:"^(?:"+l.source+")",t),n=void 0===e?Y:e>>>0;if(0==n)return[];if(0===r.length)return null===y(o,r)?[r]:[];for(var s=0,c=0,d=[];c<r.length;){o.lastIndex=C?c:0;var u,m=y(o,C?r:r.slice(c));if(null===m||(u=w(_(o.lastIndex+(C?0:c)),r.length))===s)c=b(r,c,i);else{if(d.push(r.slice(s,c)),d.length===n)return d;for(var p=1;p<=m.length-1;p++)if(d.push(m[p]),d.length===n)return d;c=s=u}}return d.push(r.slice(s)),d}]})},"44e6":function(t,e,a){t.exports=a.p+"img/logo-cropped.4ec4ea44.png"},"4d83":function(t,e,a){"use strict";a.r(e);var l,r,i,o=[function(){var t=this.$createElement,t=this._self._c||t;return t("div",{staticClass:"page-header"},[t("h1",[this._v("Billing")])])},function(){var t=this.$createElement,t=this._self._c||t;return t("div",{staticClass:"logo"},[t("img",{attrs:{src:a("44e6"),alt:"logo"}})])},function(){var t=this.$createElement,t=this._self._c||t;return t("p",[this._v("daisy@damcorp.id"),t("br"),this._v("(021) 30487010")])}],n=(a("7f7f"),a("ac6a"),a("96cf"),a("3b8d")),c=(a("28a5"),a("271f")),d=a("db49"),s=a("c1df"),u=a.n(s),s=a("2ef0"),m=a.n(s),s={name:"Invoice",data:function(){return{clientName:"",companyName:"",companyPhone:"",totalWA:0,monthValue:u()().format("YYYY-MM"),optionsMonths:[],today:u()().format("DD MMM YYYY"),getMonth:u()().month()+1,getYear:u()().year(),billWhatsapp:{},waServAlias:{text:"Whatsapp Regular Text",hsm:"Whatsapp Template Text",image:"Whatsapp Image",document:"Whatsapp Document",audio:"Whatsapp Audio"},whatsappNumber:[],whatsappBilling:[],totalBill:0,loadingTable:!0,showFormMessage:!0,currentMonth:u()().format("YYYY-MM"),showAlertError:!1,loadingExport:!1,billing_product_log:[]}},methods:{capitalizeFirstLetter:function(t){if(0<t.split("_").length){var e=[];return m.a.map(t.split("_"),function(t){e.push(t.charAt(0).toUpperCase()+t.slice(1))}),e.join(" ")}return t.charAt(0).toUpperCase()+t.slice(1)},print:function(){window.print()},changeFilter:function(){this.currentMonth=this.monthValue,this.loadingTable=!0,this.wa_billing()},formatDate:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"YYYY-MM-DD";return u()(t).format(e)},wa_billing:(i=Object(n.a)(regeneratorRuntime.mark(function t(){var i,e,s=this,a=arguments;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return i=0<a.length&&void 0!==a[0]?a[0]:"",this.loadingTable=!0,this.loadingExport=!1,e={url:d.a.baseApi+"/user/billing",method:"post",data:{months:this.currentMonth,with_date:!0},timeout:9e4},"download"==i?(e.url+="?download",e.responseType="blob"):this.totalBill=0,t.next=7,Object(c.a)(e).then(function(t){var e=new Array,o=new Array,n=0;if(200==t.data.ec||"download"==i)if(-1==t.headers["content-type"].indexOf("application/json"))try{var a=u()(s.currentMonth).format("M")==s.getMonth?s.today:u()(s.currentMonth).endOf("month").format("DD MMM YYYY"),l=window.URL.createObjectURL(new Blob([t.data],{type:t.headers["content-type"]})),r=document.createElement("a");r.href=l,r.setAttribute("download","Report Billing (Platform by DAMCorp)("+a+").xls"),r.click()}catch(t){}else{r=t.data.data.billing,t=t.data.data.update_log;s.billing_product_log=t,m.a.forEach(r,function(l){e.push(l.phone_number),o[n]=new Array;var r=new Array,i=0;m.a.forEach(l.billing,function(t){var e,a={product:t.product,delivered:t.delivered,total:t.billing,detail:t.detail};t.serviceFee?(s.totalBill+=parseFloat(t.serviceFee),r.push({product:{productName:"Service Fee",type:""},delivered:"",total:parseFloat(t.serviceFee)})):(e=0,t.detail&&(t.detail.forEach(function(t){e+=parseFloat(t.serviceFee)}),s.totalBill+=parseFloat(e),r.push({product:{productName:"Service Fee",type:""},delivered:"",total:parseFloat(e)}))),t.billingTax&&(s.totalBill+=parseFloat(t.billingTax),r.push({product:{productName:t.product.productName+" Tax",type:""},delivered:"",total:parseFloat(t.billingTax)})),o[n].push(a),i+1==l.billing.length&&m.a.forEach(r,function(t){o[n].push(t)}),Array.isArray(t.detail)?t.detail.forEach(function(t){s.totalBill+=t.total}):s.totalBill+=t.billing,i++}),n++}),s.whatsappNumber=e,s.whatsappBilling=o}else s.showFormMessage=!1}).catch(function(t){s.tokenLoader=!1,s.showAlertError=!0});case 7:this.loadingTable=!1;case 8:case"end":return t.stop()}},t,this)})),function(){return i.apply(this,arguments)}),wa_detail:(r=Object(n.a)(regeneratorRuntime.mark(function t(){var e=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(c.a)({method:"post",url:"user/detail"}).then(function(t){e.clientName=t.data.data.user.pic,e.companyName=t.data.data.user.name,e.companyPhone=t.data.data.user.phone,e.totalWA=t.data.data.sendCount}).catch(function(t){e.showAlertError=!0});case 2:case"end":return t.stop()}},t)})),function(){return r.apply(this,arguments)})},beforeMount:(l=Object(n.a)(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:for(e=6;0<=e;e--)this.optionsMonths.push({value:u()().subtract(e,"month").format("YYYY-MM"),label:u()().subtract(e,"month").format("MMM YYYY")});return t.next=3,this.wa_billing();case 3:this.loadingTable=!1;case 4:case"end":return t.stop()}},t,this)})),function(){return l.apply(this,arguments)})},n=(a("5f62"),a("2877")),o=Object(n.a)(s,function(){var l=this,t=l.$createElement,r=l._self._c||t;return r("div",{staticClass:"page-invoice scrollable"},[l._m(0),l.showAlertError?r("el-card",{staticStyle:{"margin-bottom":"1em"}},[r("error-gope-siji")],1):l._e(),l.showFormMessage?l._e():r("el-card",{attrs:{align:"center"}},[r("p",{staticStyle:{color:"#909399"},attrs:{align:"center"}},[r("img",{attrs:{src:a("c08f"),width:"100"}}),r("br"),l._v(" Sorry, you do not have billing yet. ")])]),l.showFormMessage&&!l.showAlertError?r("el-form",{attrs:{inline:!0}},[r("el-form-item",[r("el-select",{attrs:{placeholder:"Select Month"},on:{change:l.changeFilter},model:{value:l.monthValue,callback:function(t){l.monthValue=t},expression:"monthValue"}},l._l(l.optionsMonths,function(t){return r("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)],1),r("el-form-item",[r("el-button",{staticClass:"animated fadeInRight",attrs:{type:"primary",loading:l.loadingTable},on:{click:function(t){return l.wa_billing("download")}}},[r("i",{staticClass:"mdi mdi-download"}),l._v(" Download")])],1)],1):l._e(),l.showFormMessage&&!l.showAlertError?r("div",{directives:[{name:"loading",rawName:"v-loading",value:l.loadingTable,expression:"loadingTable"}],staticClass:"invoice bg-white black-text"},[r("div",{staticClass:"invoice-top"},[l._m(1),r("div",{staticClass:"info",attrs:{md:12,xs:24}},[r("h2",[l._v("DAM Corp.")]),l._m(2)]),r("div",{staticClass:"title",attrs:{md:12,xs:24}},[r("h1",[l._v("Invoice")]),r("p",[l._v("Issued: "+l._s(l.today))])])]),r("hr"),r("div",{directives:[{name:"loading",rawName:"v-loading",value:l.loadingTable,expression:"loadingTable"}],staticClass:"invoice-bottom"},[r("el-row",{staticStyle:{"margin-top":"20px"},attrs:{gutter:0}},[r("el-col",{attrs:{xs:11,sm:11,md:11,lg:11,xl:11}},[r("span",{staticClass:"header-text"},[l._v("Service Description")])]),r("el-col",{attrs:{xs:5,sm:5,md:5,lg:5,xl:5}},[r("span",{staticClass:"header-text"},[l._v("Type")])]),r("el-col",{attrs:{xs:4,sm:12,md:4,lg:4,xl:4}},[r("span",{staticClass:"header-text"},[l._v("Total Message")])]),r("el-col",{attrs:{xs:4,sm:4,md:4,lg:4,xl:4}},[r("span",{staticClass:"header-text"},[l._v("Sub total")])])],1),r("hr"),l._l(l.whatsappBilling,function(t,e){return r("el-row",{key:e,attrs:{gutter:0}},[r("el-col",{staticStyle:{"margin-bottom":"20px"},attrs:{xs:24,sm:24,md:24,lg:24,xl:24}},[r("span",[r("b",[l._v("Whatsapp Business ("+l._s(l.whatsappNumber[e])+")")])])]),r("hr"),l._l(l.whatsappBilling[e],function(a,t){return r("el-row",{key:t,staticStyle:{"margin-bottom":"0px"},attrs:{gutter:0}},[r("el-col",{staticStyle:{"margin-bottom":"10px"},attrs:{xs:2,sm:2,md:2,lg:2,xl:2}},[l._v("   ")]),r("el-col",{staticStyle:{"margin-bottom":"10px"},attrs:{xs:9,sm:9,md:9,lg:9,xl:9}},[l._v(" "+l._s(a.product.productName)+" ")]),r("el-col",{staticStyle:{"margin-bottom":"10px"},attrs:{xs:5,sm:5,md:5,lg:5,xl:5}},[l._v(" "+l._s(l.capitalizeFirstLetter(a.product.type)||" ")+" ")]),r("el-col",{staticStyle:{"margin-bottom":"10px"},attrs:{xs:4,sm:4,md:4,lg:4,xl:4}},[l._v(" "+l._s(-1!=a.product.type.toLowerCase().indexOf("notification")&&0<a.detail.length?" ":a.delivered.toLocaleString("id"))+" ")]),r("el-col",{staticStyle:{"margin-bottom":"10px"},attrs:{xs:4,sm:4,md:4,lg:4,xl:4}},[l._v(" "+l._s(-1!=a.product.type.toLowerCase().indexOf("notification")&&0<a.detail.length?" ":"Rp "+a.total.toLocaleString("id",{minimumFractionDigits:0==Number.isInteger(a.total)?4:void 0}))+" ")]),r("hr"),l._l(a.detail,function(t,e){return-1!=a.product.type.toLowerCase().indexOf("notification")&&0<a.detail.length?r("el-row",{key:e,attrs:{gutter:0}},[r("el-col",{staticStyle:{"margin-bottom":"10px"},attrs:{xs:3,sm:3,md:3,lg:3,xl:3}},[l._v("   ")]),r("el-col",{staticStyle:{"margin-bottom":"10px"},attrs:{xs:9,sm:9,md:9,lg:9,xl:9}},[l._v(" "+l._s(t.countryCode)+" ")]),r("el-col",{staticStyle:{"margin-bottom":"10px"},attrs:{xs:4,sm:4,md:4,lg:4,xl:4}},[l._v(" "+l._s(t.name)+" ")]),r("el-col",{staticStyle:{"margin-bottom":"10px"},attrs:{xs:4,sm:4,md:4,lg:4,xl:4}},[l._v(" "+l._s(t.count.toLocaleString("id")||"0")+" ")]),r("el-col",{staticStyle:{"margin-bottom":"10px"},attrs:{xs:4,sm:4,md:4,lg:4,xl:4}},[l._v(" Rp "+l._s(t.total.toLocaleString("id",{minimumFractionDigits:0==Number.isInteger(t.total)?4:void 0}))+" ")]),r("hr")],1):l._e()})],2)})],2)}),0<l.billing_product_log.length?r("el-row",{attrs:{gutter:0}},[r("el-col",{staticStyle:{"margin-bottom":"10px"},attrs:{xs:24,sm:24,md:24,lg:24,xl:24}},[r("span",[r("b",[l._v("Note")])])]),r("hr"),l._l(l.billing_product_log,function(t,e){return r("el-row",{key:e,staticStyle:{"margin-bottom":"0px"},attrs:{gutter:0}},[r("el-col",{staticStyle:{"margin-bottom":"10px"},attrs:{xs:2,sm:2,md:2,lg:2,xl:2}},[l._v("   ")]),r("el-col",{staticStyle:{"margin-bottom":"10px"},attrs:{xs:9,sm:9,md:9,lg:9,xl:9}},[l._v(" "+l._s(l.formatDate(t.createdAt,"DD MMM YYYY, HH:mm"))+" ")]),r("el-col",{staticStyle:{"margin-bottom":"10px"},attrs:{xs:9,sm:9,md:9,lg:9,xl:9}},[l._v(" "+l._s(t.reff_note)+" ")]),r("el-col",{staticStyle:{"margin-bottom":"10px"},attrs:{xs:4,sm:4,md:4,lg:4,xl:4}},[l._v("   ")]),r("hr")],1)})],2):l._e(),r("el-row",{attrs:{gutter:0}},[r("el-col",{attrs:{xs:18,sm:18,md:18,lg:18,xl:18}},[r("h2",{staticStyle:{"font-size":"24px"}},[l._v("Total")])]),r("el-col",{attrs:{xs:6,sm:6,md:6,lg:6,xl:6}},[r("h2",{staticStyle:{"font-size":"24px"}},[l._v("Rp "+l._s(l.totalBill.toLocaleString("id",{minimumFractionDigits:0==Number.isInteger(l.totalBill)?4:void 0})))])])],1)],2)]):l._e()],1)},o,!1,null,null,null);e.default=o.exports},"5f62":function(t,e,a){"use strict";a("bf2d")},aae3e:function(t,e,a){var l=a("d3f4"),r=a("2d95"),i=a("2b4c")("match");t.exports=function(t){var e;return l(t)&&(void 0!==(e=t[i])?!!e:"RegExp"==r(t))}},bf2d:function(t,e,a){},c08f:function(t,e,a){t.exports=a.p+"img/no_billing@3x.d9ca18a2.png"}}]);