(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-vendors~b53e8b1b"],{f2d9:function(e,t,n){"use strict";(function(e){"undefined"!==typeof window?window:"undefined"!==typeof e||"undefined"!==typeof self&&self;function n(e,t){return t={exports:{}},e(t,t.exports),t.exports}var o=n((function(e,t){(function(t,n){e.exports=n()})(0,(function(){return function e(t,n,o){var r,a,i=window,s="application/octet-stream",l=o||s,d=t,c=!n&&!o&&d,u=document.createElement("a"),f=function(e){return String(e)},h=i.Blob||i.MozBlob||i.WebKitBlob||f,p=n||"download";if(h=h.call?h.bind(i):Blob,"true"===String(this)&&(d=[d,l],l=d[0],d=d[1]),c&&c.length<2048&&(p=c.split("/").pop().split("?")[0],u.href=c,-1!==u.href.indexOf(c))){var m=new XMLHttpRequest;return m.open("GET",c,!0),m.responseType="blob",m.onload=function(t){e(t.target.response,p,s)},setTimeout((function(){m.send()}),0),m}if(/^data:([\w+-]+\/[\w+.-]+)?[,;]/.test(d)){if(!(d.length>2096103.424&&h!==f))return navigator.msSaveBlob?navigator.msSaveBlob(x(d),p):v(d);d=x(d),l=d.type||s}else if(/([\x80-\xff])/.test(d)){var b=0,y=new Uint8Array(d.length),w=y.length;for(b;b<w;++b)y[b]=d.charCodeAt(b);d=new h([y],{type:l})}function x(e){var t=e.split(/[:;,]/),n=t[1],o="base64"==t[2]?atob:decodeURIComponent,r=o(t.pop()),a=r.length,i=0,s=new Uint8Array(a);for(i;i<a;++i)s[i]=r.charCodeAt(i);return new h([s],{type:n})}function v(e,t){if("download"in u)return u.href=e,u.setAttribute("download",p),u.className="download-js-link",u.innerHTML="downloading...",u.style.display="none",document.body.appendChild(u),setTimeout((function(){u.click(),document.body.removeChild(u),!0===t&&setTimeout((function(){i.URL.revokeObjectURL(u.href)}),250)}),66),!0;if(/(Version)\/(\d+)\.(\d+)(?:\.(\d+))?.*Safari\//.test(navigator.userAgent))return/^data:/.test(e)&&(e="data:"+e.replace(/^data:([\w\/\-\+]+)/,s)),window.open(e)||confirm("Displaying New Document\n\nUse Save As... to download, then click back to return to this page.")&&(location.href=e),!0;var n=document.createElement("iframe");document.body.appendChild(n),!t&&/^data:/.test(e)&&(e="data:"+e.replace(/^data:([\w\/\-\+]+)/,s)),n.src=e,setTimeout((function(){document.body.removeChild(n)}),333)}if(r=d instanceof h?d:new h([d],{type:l}),navigator.msSaveBlob)return navigator.msSaveBlob(r,p);if(i.URL)v(i.URL.createObjectURL(r),!0);else{if("string"===typeof r||r.constructor===f)try{return v("data:"+l+";base64,"+i.btoa(r))}catch(g){return v("data:"+l+","+encodeURIComponent(r))}a=new FileReader,a.onload=function(e){v(this.result)},a.readAsDataURL(r)}return!0}}))})),r={props:{type:{type:String,default:"xls"},data:{type:Array,required:!1,default:null},fields:{type:Object,required:!1},exportFields:{type:Object,required:!1},defaultValue:{type:String,required:!1,default:""},title:{default:null},footer:{default:null},name:{type:String,default:"data.xls"},fetch:{type:Function},meta:{type:Array,default:()=>[]},worksheet:{type:String,default:"Sheet1"},beforeGenerate:{type:Function},beforeFinish:{type:Function}},computed:{idName(){var e=(new Date).getTime();return"export_"+e},downloadFields(){return void 0!==this.fields?this.fields:void 0!==this.exportFields?this.exportFields:void 0}},methods:{async generate(){"function"===typeof this.beforeGenerate&&await this.beforeGenerate();let e=this.data;if("function"!==typeof this.fetch&&e||(e=await this.fetch()),!e||!e.length)return;let t=this.getProcessedJson(e,this.downloadFields);return"html"===this.type?this.export(this.jsonToXLS(t),this.name.replace(".xls",".html"),"text/html"):"csv"===this.type?this.export(this.jsonToCSV(t),this.name.replace(".xls",".csv"),"application/csv"):this.export(this.jsonToXLS(t),this.name,"application/vnd.ms-excel")},export:async function(e,t,n){let r=this.base64ToBlob(e,n);"function"===typeof this.beforeFinish&&await this.beforeFinish(),o(r,t,n)},jsonToXLS(e){let t='<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head><meta name=ProgId content=Excel.Sheet> <meta name=Generator content="Microsoft Excel 11"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">\x3c!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>${worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\x3e<style>br {mso-data-placement: same-cell;}</style></head><body><table>${table}</table></body></html>',n="<thead>";const o=Object.keys(e[0]).length;let r=this;null!=this.title&&(n+=this.parseExtraData(this.title,'<tr><th colspan="'+o+'">${data}</th></tr>')),n+="<tr>";for(let a in e[0])n+="<th>"+a+"</th>";return n+="</tr>",n+="</thead>",n+="<tbody>",e.map((function(e,t){n+="<tr>";for(let o in e)n+="<td>"+r.valueReformattedForMultilines(e[o])+"</td>";n+="</tr>"})),n+="</tbody>",null!=this.footer&&(n+="<tfoot>",n+=this.parseExtraData(this.footer,'<tr><td colspan="'+o+'">${data}</td></tr>'),n+="</tfoot>"),t.replace("${table}",n).replace("${worksheet}",this.worksheet)},jsonToCSV(e){var t=[];null!=this.title&&t.push(this.parseExtraData(this.title,"${data}\r\n"));for(let n in e[0])t.push(n),t.push(",");return t.pop(),t.push("\r\n"),e.map((function(e){for(let n in e){let o='="'+e[n]+'"';o.match(/[,"\n]/)&&(o='"'+o.replace(/\"/g,'""')+'"'),t.push(o),t.push(",")}t.pop(),t.push("\r\n")})),null!=this.footer&&t.push(this.parseExtraData(this.footer,"${data}\r\n")),t.join("")},getProcessedJson(e,t){let n=this.getKeys(e,t),o=[],r=this;return e.map((function(e,t){let a={};for(let o in n){let t=n[o];a[o]=r.getValue(t,e)}o.push(a)})),o},getKeys(e,t){if(t)return t;let n={};for(let o in e[0])n[o]=o;return n},parseExtraData(e,t){let n="";if(Array.isArray(e))for(var o=0;o<e.length;o++)n+=t.replace("${data}",e[o]);else n+=t.replace("${data}",e);return n},getValue(e,t){const n="object"!==typeof e?e:e.field;let o="string"!==typeof n?[]:n.split("."),r=this.defaultValue;return r=n?o.length>1?this.getValueFromNestedItem(t,o):this.parseValue(t[n]):t,e.hasOwnProperty("callback")&&(r=this.getValueFromCallback(r,e.callback)),r},valueReformattedForMultilines(e){return"string"==typeof e?e.replace(/\n/gi,"<br/>"):e},getValueFromNestedItem(e,t){let n=e;for(let o of t)n&&(n=n[o]);return this.parseValue(n)},getValueFromCallback(e,t){if("function"!==typeof t)return this.defaultValue;const n=t(e);return this.parseValue(n)},parseValue(e){return e||0===e||"boolean"===typeof e?e:this.defaultValue},base64ToBlob(e,t){let n=window.btoa(window.unescape(encodeURIComponent(e))),o=atob(n),r=o.length,a=new Uint8ClampedArray(r);while(r--)a[r]=o.charCodeAt(r);return new Blob([a],{type:t})}}};function a(e,t,n,o,r,a,i,s,l,d){"boolean"!==typeof i&&(l=s,s=i,i=!1);var c,u="function"===typeof n?n.options:n;if(e&&e.render&&(u.render=e.render,u.staticRenderFns=e.staticRenderFns,u._compiled=!0,r&&(u.functional=!0)),o&&(u._scopeId=o),a?(c=function(e){e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,e||"undefined"===typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),t&&t.call(this,l(e)),e&&e._registeredComponents&&e._registeredComponents.add(a)},u._ssrRegister=c):t&&(c=i?function(){t.call(this,d(this.$root.$options.shadowRoot))}:function(e){t.call(this,s(e))}),c)if(u.functional){var f=u.render;u.render=function(e,t){return c.call(t),f(e,t)}}else{var h=u.beforeCreate;u.beforeCreate=h?[].concat(h,c):[c]}return n}var i=a;const s=r;var l=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:e.idName},on:{click:e.generate}},[e._t("default",[e._v("\n\t\tDownload "+e._s(e.name)+"\n\t")])],2)},d=[];l._withStripped=!0;const c=void 0,u=void 0,f=void 0,h=!1;var p=i({render:l,staticRenderFns:d},c,s,u,h,f,void 0,void 0);t["a"]=p}).call(this,n("c8ba"))}}]);