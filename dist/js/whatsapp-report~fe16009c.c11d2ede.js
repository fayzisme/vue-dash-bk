(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["whatsapp-report~fe16009c"],{"0eaf":function(e,t,a){"use strict";a("e267")},5873:function(e,t,a){"use strict";a("7ce7")},"5da0":function(e,t,a){},"7caa":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loadingPage,expression:"loadingPage"}],staticClass:"scrollable only-y"},[e._m(0),e.showAlertMessage?s("el-card",{attrs:{align:"center"}},[s("h2",{attrs:{align:"center"}},[e._v("Start messaging your customers today")]),s("p",{domProps:{innerHTML:e._s(e.$t("promote.desc.whatsapp"))}}),s("br"),s("br"),s("span",[s("el-button",{on:{click:function(t){return e.mailto()}}},[e._v("Send us e-mail")])],1)]):s("el-card",[e.showAlertMessage||e.showAlertError?e._e():s("el-row",{staticStyle:{"z-index":"0"},attrs:{gutter:10}},[s("el-col",{staticClass:"mt-10",attrs:{xs:24,sm:24,md:24,lg:24,xl:24}},[s("el-button",{staticStyle:{"margin-bottom":"22px"},attrs:{type:"primary",loading:e.loadingTable},on:{click:function(t){return e.doShowDialogUploadMedia()}}},[e._v("Upload Media")]),e.showAlertMessage||e.showAlertError?e._e():s("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0}},[s("el-form-item",[s("el-date-picker",{staticStyle:{width:"275px"},attrs:{size:"mini","picker-options":e.pickerOptions,"unlink-panels":!0,editable:!1,type:"daterange","range-separator":"To","start-placeholder":"Start date","end-placeholder":"End date"},model:{value:e.selectedStartDate,callback:function(t){e.selectedStartDate=t},expression:"selectedStartDate"}})],1),s("el-form-item",[s("el-select",{staticStyle:{width:"150px"},attrs:{size:"mini",placeholder:"Select Phone Number","default-first-option":!0},model:{value:e.sender,callback:function(t){e.sender=t},expression:"sender"}},e._l(e.waUserDetail.sender,(function(e){return s("el-option",{key:e,staticStyle:{width:"150px"},attrs:{label:e,value:e}})})),1)],1),s("el-form-item",[s("el-input",{staticClass:"search-contact",staticStyle:{float:"left !important",width:"300px"},attrs:{size:"mini","prefix-icon":"el-icon-search",placeholder:"Search by Id",clearable:""},model:{value:e.searchingData,callback:function(t){e.searchingData=t},expression:"searchingData"}})],1),s("el-form-item",[s("el-button",{staticClass:"animated fadeInRight",attrs:{type:"primary",size:"mini"},on:{click:e.changeFilter}},[s("i",{staticClass:"el-icon-search"})])],1)],1),s("el-card",{attrs:{shadow:"card-shadow--small"}},[s("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loadingPage,expression:"loadingPage"}],staticClass:"group-list scrollable only-y"},[s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:20,offset:2}},[s("el-pagination",{staticClass:"mb-10",attrs:{background:"","prev-text":"Prev","next-text":"Next",layout:"prev, pager, next","page-size":50,"current-page":e.currentPage,total:e.total},on:{"current-change":e.paginateReport}}),[s("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loadingTable,expression:"loadingTable"}],staticStyle:{width:"100%",color:"#000 !important",border:"1px solid #EBEEF5"},attrs:{height:"500",data:e.mediaData,"element-loading-text":"Loading...","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(246, 246, 245, 0.8)"}},[s("el-table-column",{attrs:{fixed:"",width:"300",prop:"dateTime",label:"Date"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.format(t.row.date,"DD/MM/YYYY, HH:mm"))+" ")]}}],null,!1,2230589617)}),s("el-table-column",{attrs:{width:"500",prop:"id",label:"Media ID"}}),s("el-table-column",{attrs:{prop:"url",label:"URL Source",width:"500"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("a",{attrs:{target:"blank",href:t.row.url}},[e._v(e._s(t.row.url))])]}}],null,!1,3428162807)}),s("template",{staticStyle:{height:"500px"},slot:"empty"},[s("p",[s("img",{attrs:{src:a("7e53"),width:"100"}}),s("br"),e._v("No data ")])])],2)],s("el-pagination",{staticClass:"mt-10",attrs:{background:"","prev-text":"Prev","next-text":"Next",layout:"prev, pager, next","page-size":50,"current-page":e.currentPage,total:e.total},on:{"current-change":e.paginateReport}})],2)],1)],1)])],1)],1)],1),s("el-dialog",{attrs:{title:"Upload Media",visible:e.uploadMedia.visible},on:{close:e.closeDialog,"update:visible":function(t){return e.$set(e.uploadMedia,"visible",t)}}},[s("el-row",{attrs:{gutter:10}},[s("el-col",{staticClass:"mt-10",attrs:{xs:6,sm:6,md:6,lg:6,xl:6}},[s("h4",[e._v("Media Type")])]),s("el-col",{staticClass:"mt-20",attrs:{xs:18,sm:18,md:18,lg:18,xl:18}},[s("el-select",{attrs:{placeholder:"Select media type"},model:{value:e.media.type,callback:function(t){e.$set(e.media,"type",t)},expression:"media.type"}},e._l(e.optionsType,(function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),s("el-row",{attrs:{gutter:10}},[s("el-col",{staticClass:"mt-10",attrs:{xs:6,sm:6,md:6,lg:6,xl:6}},[s("h4",[e._v("Phone Number")])]),s("el-col",{staticClass:"mt-20",attrs:{xs:18,sm:18,md:18,lg:18,xl:18}},[s("el-select",{attrs:{disabled:"-"==e.media.type,placeholder:"Select Phone Number"},model:{value:e.phoneNumber,callback:function(t){e.phoneNumber=t},expression:"phoneNumber"}},e._l(e.waUserDetail.sender,(function(e){return s("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1)],1),s("el-row",{attrs:{gutter:10}},[s("el-col",{staticClass:"mt-10",attrs:{xs:6,sm:6,md:6,lg:6,xl:6}},[s("h4",[e._v("Media Source")])]),s("el-col",{staticClass:"mt-20",attrs:{xs:18,sm:18,md:18,lg:18,xl:18}},[s("el-select",{attrs:{disabled:""==e.phoneNumber,placeholder:"Select media source"},model:{value:e.mediaSource,callback:function(t){e.mediaSource=t},expression:"mediaSource"}},e._l(e.options,(function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),"url"==e.mediaSource?s("el-row",[s("el-col",{staticClass:"mt-10",attrs:{xs:6,sm:6,md:6,lg:6,xl:6}},[s("h4",[e._v("Url")])]),s("el-col",{staticClass:"mt-20",attrs:{xs:18,sm:18,md:18,lg:18,xl:18}},["url"==e.mediaSource?s("el-input",{attrs:{type:"text",placeholder:"Insert Media URL here"},model:{value:e.media.url,callback:function(t){e.$set(e.media,"url",t)},expression:"media.url"}}):e._e()],1)],1):e._e(),"local"==e.mediaSource?s("el-row",[s("el-col",{staticClass:"mt-10",attrs:{xs:6,sm:6,md:6,lg:6,xl:6}},[s("h4",[e._v("File")])]),s("el-col",{staticClass:"mt-20",attrs:{xs:18,sm:18,md:18,lg:18,xl:18}},["image"==e.media.type?s("el-upload",{staticClass:"upload-demo",attrs:{id:"inputMedia","http-request":e.renderMedia,action:"","on-preview":e.handlePreview,"on-remove":e.handleRemove,"before-upload":e.beforeUploadMedia,"before-remove":e.beforeRemove,"file-list":e.handleListMedia,drag:"","list-type":"picture",limit:1,"on-exceed":e.handleExceed},model:{value:e.media.url,callback:function(t){e.$set(e.media,"url",t)},expression:"media.url"}},[s("i",{staticClass:"el-icon-upload"}),s("div",{staticClass:"el-upload__text",on:{click:e.renderMedia}},[e._v("Drop file here or "),s("em",[e._v("click to upload")])]),s("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[s("b",[e._v("The maximum file upload size is 5 MB")])])]):e._e(),"document"==e.media.type?s("el-upload",{staticClass:"upload-demo",attrs:{id:"inputMedia","http-request":e.renderMedia,action:"","on-preview":e.handlePreview,"before-upload":e.beforeUploadMedia,"on-remove":e.handleRemove,"before-remove":e.beforeRemove,drag:"","list-type":"text","file-list":e.handleListMedia,limit:1,"on-exceed":e.handleExceed},model:{value:e.media.url,callback:function(t){e.$set(e.media,"url",t)},expression:"media.url"}},[s("i",{staticClass:"el-icon-upload"}),s("div",{staticClass:"el-upload__text",on:{click:e.renderMedia}},[e._v("Drop file here or "),s("em",[e._v("click to upload")])]),s("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[s("b",[e._v("The maximum file upload size is 100 MB")])])]):e._e(),"video"==e.media.type?s("el-upload",{staticClass:"upload-demo",attrs:{id:"inputMedia","http-request":e.renderMedia,action:"","on-preview":e.handlePreview,"before-upload":e.beforeUploadMedia,"on-remove":e.handleRemove,"before-remove":e.beforeRemove,drag:"","list-type":"text","file-list":e.handleListMedia,limit:1,"on-exceed":e.handleExceed},model:{value:e.media.url,callback:function(t){e.$set(e.media,"url",t)},expression:"media.url"}},[s("i",{staticClass:"el-icon-upload"}),s("div",{staticClass:"el-upload__text",on:{click:e.renderMedia}},[e._v("Drop file here or "),s("em",[e._v("click to upload")])]),s("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[s("b",[e._v("The maximum file upload size is 16 MB")])])]):e._e(),s("el-progress",{attrs:{percentage:e.uploadMediaProgress}})],1)],1):e._e(),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{type:"primary",loading:e.loadingUploadMedia,disabled:0!=e.loadingUploadMedia},on:{click:e.submitUploadMedia}},[e._v(e._s(e.$t("submit")))])],1)],1)],1)},i=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page-header"},[a("h1",[e._v("List Media")])])}],r=(a("3b2b"),a("7f7f"),a("96cf"),a("1da1")),l=(a("7514"),a("ade3")),n=(a("bce9"),a("271f")),o=a("db49"),d=(a("c0d6"),a("7f45")),c=a.n(d),u=(a("b730"),a("aeb1"),a("2ef0")),p=a.n(u),m=a("bc3a"),h={data:function(){var e;return e={documentFileName:"",loadingUploadMedia:!1,uploadMediaProgress:0,handleListMedia:[],mediaSource:"",media:{url:"",type:"-"},uploadMedia:{visible:!1},optionsType:[{value:"image",label:"Image"},{value:"video",label:"Video"},{value:"document",label:"Document"}],options:[{value:"local",label:"Local Computer"},{value:"url",label:"URL"}]},Object(l["a"])(e,"mediaSource",""),Object(l["a"])(e,"valueFilter","to"),Object(l["a"])(e,"searchingData",""),Object(l["a"])(e,"timeoutReport",null),Object(l["a"])(e,"selectedRows",{}),Object(l["a"])(e,"modalInvalid",!1),Object(l["a"])(e,"activeTab","report"),Object(l["a"])(e,"lists",[]),Object(l["a"])(e,"hsmRateData",[]),Object(l["a"])(e,"loadingHsmRate",!1),Object(l["a"])(e,"bodyStyle",{padding:"20px"}),Object(l["a"])(e,"loadingReportTable",!1),Object(l["a"])(e,"loadingExport",!1),Object(l["a"])(e,"selectedStartDate",[c()().format("YYYY-MM-DD"),c()().format("YYYY-MM-DD")]),Object(l["a"])(e,"selectedStartDateRate",[c()().format("YYYY-MM-DD"),c()().format("YYYY-MM-DD")]),Object(l["a"])(e,"selectedYear",c()().format("YYYY")),Object(l["a"])(e,"selectedMonth",c()().format("M")),Object(l["a"])(e,"loadingPage",!0),Object(l["a"])(e,"loading",!1),Object(l["a"])(e,"tabLoading",!1),Object(l["a"])(e,"reportTabLoading",!1),Object(l["a"])(e,"loadingTable",!1),Object(l["a"])(e,"reportData",[]),Object(l["a"])(e,"dateRange",[new Date,new Date]),Object(l["a"])(e,"pickerOptions",{disabledDate:function(e){var t=c()(),a=t.diff(c()(e),"d");return a>90||a<0||0==a&&0==t.isSame(c()(e),"d")}}),Object(l["a"])(e,"loadingExport",!1),Object(l["a"])(e,"pageSize","2"),Object(l["a"])(e,"onPage","1"),Object(l["a"])(e,"totalCount",1e5),Object(l["a"])(e,"resData",[]),Object(l["a"])(e,"mediaData",[]),Object(l["a"])(e,"startDate",new Date),Object(l["a"])(e,"endDate",new Date),Object(l["a"])(e,"excelFields",{Date:"dateTimeIso",Time:"dateTimeIso",From:"from",To:"to",Delivered:"delivered"}),Object(l["a"])(e,"excelData",[]),Object(l["a"])(e,"excelFilename","Report Notification (Platform by DAMCorp).xls"),Object(l["a"])(e,"pageNotAllowed",!1),Object(l["a"])(e,"showAlertError",!1),Object(l["a"])(e,"showAlertMessage",!1),Object(l["a"])(e,"value",c()().format("M")),Object(l["a"])(e,"optionsYear",[]),Object(l["a"])(e,"year","2019"),Object(l["a"])(e,"waUserDetail",{sender:[]}),Object(l["a"])(e,"sender",""),Object(l["a"])(e,"phoneNumber",""),Object(l["a"])(e,"currentPage",1),Object(l["a"])(e,"total",0),Object(l["a"])(e,"dateRange",[new Date,new Date]),e},methods:{closeDialog:function(){this.uploadMedia.visible=!1,this.handleRemove()},handleExceed:function(e,t){},beforeRemove:function(e,t){},handlePreview:function(e){},handleRemove:function(e,t){this.media.url="",this.uploadMediaProgress=0,this.handleListMedia=[]},doShowDialogUploadMedia:function(){this.uploadMedia.visible=!0},errorMessage:function(e){return"failed"!=e.status&&"fail"!=e.status||!e.latest_error_message?e.status.charAt(0).toUpperCase()+e.status.slice(1):"Failed. "+e.latest_error_message},callback:function(e){this.onPage=e,this.getAllMedia()},print:function(){window.print()},monthName:function(e){var t=p.a.find(this.options,"value");return t.label},format:function(e,t){return c()(e).format(t)},changeFilter:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.currentPage=1,e.next=3,this.getAllMedia(1);case 3:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),loadWA:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(n["a"])({method:"post",url:o["a"].baseApi+"user/detail/number",data:{channels:"whatsapp"}}).then((function(e){200==e.data.ec?(t.showFormMessage=!0,t.waUserDetail.sender=p.a.uniq(e.data.data),t.sender=t.waUserDetail.sender[0]):400==e.data.ec&&"not_subscribe"==e.data.message?t.showAlertMessage=!0:t.showAlertError=!0})).catch((function(e){t.showAlertError=!0}));case 2:this.loadingPage=!1;case 3:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),getAllMedia:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t,a,s,i=this,r=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=r.length>0&&void 0!==r[0]?r[0]:1,a=r.length>1&&void 0!==r[1]?r[1]:"",this.showAlertError=!1,this.loadingTable=!0,this,s={url:o["a"].baseApi+"/upload_media/all?page="+t,method:"post",data:{number:this.sender,startDate:c()(this.selectedStartDate[0]).format("YYYY-MM-DD"),endDate:c()(this.selectedStartDate[1]).format("YYYY-MM-DD")}},""!=a&&(s.url="".concat(o["a"].baseApi,"/upload_media/").concat(a)),e.next=9,Object(n["a"])(s).then((function(e){var t=c()([i.year,i.value-1]).endOf("month").format("DD MMM YYYY");i.value==c()().month()+1&&i.year==c()().year()&&c()().format("DD MMM YYYY"),200==e.data.ec?(i.mediaData=e.data.data.media,i.total=i.mediaData.length):e.data.ec>=400?i.$swal(i.$t("info"),"Not Found","info"):i.$swal(i.$t("error"),i.$t("error_text"),"error"),i.loadingTable=!1})).catch((function(e){i.loadingTable=!1,i.$swal(i.$t("error"),i.$t("error_text"),"error")}));case 9:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),paginateReport:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.currentPage=t,e.next=3,this.getAllMedia(this.currentPage);case 3:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),onUploadMedia:function(e){var t=this,a=e.target;if(a.files&&a.files[0]){var s=new FileReader;s.onload=function(e){e.target.result;var s=a.files[0].type;-1==p.a.indexOf(["data/*"],s)&&(document.getElementById("inputMedia").value="",t.$swal(t.$t("error"),"File type not allowed","error"))},s.readAsText(a.files[0])}},beforeUploadMedia:function(e){return"image"==this.media.type.toLowerCase()&&-1==["image/jpeg","image/png"].indexOf(e.type)?(this.closeDialog(),this.$swal(this.$t("error"),"Media extension not match (.jpeg / .png)","warning"),!1):"document"==this.media.type.toLowerCase()&&-1==["application/pdf"].indexOf(e.type)?(this.closeDialog(),this.$swal(this.$t("error"),"Media extension not match (.pdf)","warning"),!1):"video"==this.media.type.toLowerCase()&&-1==["video/mp4","video/avi","video/x-matroska"].indexOf(e.type)?(this.closeDialog(),this.$swal(this.$t("error"),"Media extension not match (.mp4 / .avi / .mkv)","warning"),!1):void 0},renderMedia:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t){var a,s=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(a=new FormData,document.getElementById("inputMedia"),this.documentFileName=t.file.name,"image"!=this.media.type.toLowerCase()||"local"!=this.mediaSource){e.next=10;break}if(!(t.file.size>=5242880)){e.next=8;break}return this.closeDialog(),this.$swal(this.$t("error"),"Maximum file upload size is 5 MB","warning"),e.abrupt("return");case 8:e.next=22;break;case 10:if("document"!=this.media.type.toLowerCase()||"local"!=this.mediaSource){e.next=17;break}if(!(t.file.size>=104857600)){e.next=15;break}return this.closeDialog(),this.$swal(this.$t("error"),"Maximum file upload size is 100 MB","warning"),e.abrupt("return");case 15:e.next=22;break;case 17:if("video"!=this.media.type.toLowerCase()||"local"!=this.mediaSource){e.next=22;break}if(!(t.file.size>=16777216)){e.next=22;break}return this.closeDialog(),this.$swal(this.$t("error"),"Maximum file upload size is 16 MB","warning"),e.abrupt("return");case 22:return this.loadingUploadMedia=!0,a.append("media",t.file),a.append("type","upload_media"),m.defaults.timeout=9e5,e.next=28,m.post(o["a"].baseApi+"upload/media",a,{maxContentLength:1/0,maxBodyLength:1/0,headers:{"Content-Type":"multipart/form-data"},onUploadProgress:function(e){var t=parseInt(e.total/e.loaded);t=t>100?100:t,s.uploadMediaProgress=t>1?90-t:90}}).then((function(e){200==e.data.ec?(s.media.url=e.data.data.url,s.uploadMediaProgress=100):(s.closeDialog(),s.$swal(s.$t("error"),"render media error","error")),s.loadingUploadMedia=!1})).catch((function(e){console.log(e),s.closeDialog(),s.$swal(s.$t("error"),"render media error","error"),s.loadingUploadMedia=!1}));case 28:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),submitUploadMedia:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t,a,s,i,r=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.loadingUploadMedia=!0,"url"!=this.mediaSource){e.next=26;break}if(t=new RegExp("^(https?:\\/\\/)?((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.)+[a-z]{2,}|((\\d{1,3}\\.){3}\\d{1,3}))(\\:\\d+)?(\\/[-a-z\\d%_.~+]*)*(\\?[;&a-z\\d%_.~+=-]*)?(\\#[-a-z\\d_]*)?$","i"),t.test(this.media.url.toLowerCase())){e.next=10;break}return this.loadingUploadMedia=!1,this.closeDialog(),this.$swal(this.$t("error"),"Make sure your media url is valid!","warning"),e.abrupt("return");case 10:a=[],e.t0=this.media.type,e.next="image"===e.t0?14:"document"===e.t0?16:"video"===e.t0?18:20;break;case 14:return a=[".jpeg",".jpg",".png"],e.abrupt("break",20);case 16:return a=[".doc",".docx",".pdf"],e.abrupt("break",20);case 18:return a=[".mp4",".avi",".mkv"],e.abrupt("break",20);case 20:if(s=new RegExp("([a-zA-Z0-9s_\\.-:])+("+a.join("|")+")$"),s.test(this.media.url.toLowerCase())){e.next=26;break}return this.loadingUploadMedia=!1,this.closeDialog(),this.$swal(this.$t("error"),"Media extension not match (".concat(a.join(),")"),"warning"),e.abrupt("return");case 26:return i={url:this.media.url,number:this.phoneNumber,type:this.media.type},e.next=29,Object(n["a"])({method:"post",url:o["a"].baseApi+"upload_media",timeout:3e5,data:i}).then((function(e){200==e.data.ec?r.$swal({title:r.$t("success"),text:"",type:"success"}).then((function(e){e&&r.getAllMedia()})):400==e.data.ec?r.$swal(r.$t("info"),r.$t("whatsapp.missing_parameter"),"info"):r.$swal(r.$t("error"),r.$t("error_500"),"error"),r.loadingUploadMedia=!1,r.uploadMedia.visible=!1})).catch((function(e){console.log(e),e.message?r.$swal(r.$t("error"),"".concat(e.message),"error"):r.$swal(r.$t("error"),r.$t("error_text"),"error"),r.loadingUploadMedia=!1,r.uploadMedia.visible=!1}));case 29:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},computed:{},mounted:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){var t,a,s,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:for(t=[],a=0,s=(new Date).getFullYear(),i=(new Date).getFullYear()-2,a=s;a>=i;a--)t.push({value:a,label:a});return this.optionsYear=t,e.next=8,this.loadWA();case 8:0==this.showAlertError&&0==this.showAlertMessage?this.getAllMedia():this.loadingPage=!1,this.monthName(1);case 10:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},g=h,f=(a("c1e1"),a("5873"),a("2877")),b=Object(f["a"])(g,s,i,!1,null,"04da2704",null);t["default"]=b.exports},"7ce7":function(e,t,a){},b363:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"scrollable only-y"},[e._m(0),e.showAlertMessage?a("el-card",{staticStyle:{"margin-bottom":"1em"},attrs:{align:"center"}},[a("h2",[e._v("Start messaging your customers today")]),a("span",{domProps:{innerHTML:e._s(e.$t("promote.desc.whatsapp"))}}),a("br"),a("br"),a("span",[a("el-button",{on:{click:function(t){return e.mailto()}}},[e._v("Send us e-mail")])],1)]):e._e(),a("el-tabs",{attrs:{type:"border-card"},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},[a("el-tab-pane",{attrs:{label:"Request",name:"request"}},[a("div",{staticClass:"mt-10",staticStyle:{"margin-bottom":"1em","box-shadow":"none"}},[a("el-row",{directives:[{name:"loading",rawName:"v-loading",value:e.loadingPage,expression:"loadingPage"}],staticClass:"mt-0",attrs:{gutter:30}},[a("el-col",{attrs:{xs:24,sm:24,md:24,lg:24,xl:24}},[a("el-card",{staticClass:"mb-20",staticStyle:{"background-color":"beige",border:"none","box-shadow":"none"}},[a("el-row",{staticClass:"mt-0 mb-20",attrs:{gutter:30}},[a("el-col",{attrs:{xs:24,sm:24,md:24,lg:24,xl:24}},[a("p",{staticClass:"font-size-12"},[a("b",[e._v("*Note: ")]),a("br"),a("br"),e._v(" When creating a Message Template, you must have the following: "),a("ol",[a("li",[e._v("Message Template name — Can only contain lowercase alphanumeric characters and underscores ( _ ). No other characters or white space are allowed. ")]),a("li",[e._v("Message Template in the correct format — Should be a string where the variables are replaced with "),a("b",{domProps:{innerHTML:e._s("{{#}}")}}),e._v(" where the number represents the variable index. Note: Variables must begin at "),a("b",{domProps:{innerHTML:e._s("{{1}}")}}),e._v(".")]),a("li",[e._v(" If you use the "),a("b",[e._v("headers")]),e._v(" or "),a("b",[e._v("footers")]),e._v(" on your message templates, then you can only enter "),a("b",[e._v("1024 character")]),e._v(" message templates (included with the message parameters). ")]),a("li",[e._v(" The Footer field can't have more than "),a("b",[e._v("60 characters")]),e._v(". ")])]),e._v(" Example: "),a("br"),a("pre",{staticClass:"font-size-12",staticStyle:{"word-wrap":"break-word","white-space":"pre-wrap !important"},domProps:{innerHTML:e._s("Your order {{1}} for a total of {{2}} is confirmed. The expected delivery is {{3}}.")}})])])],1)],1)],1),a("el-col",{attrs:{xs:24,sm:24,md:24,lg:24,xl:24}},[a("el-card",{staticStyle:{"box-shadow":"none"}},[a("el-row",{attrs:{gutter:30}},[a("el-col",{attrs:{xs:8,sm:8,md:8,lg:4,xl:4}},[a("h5",[e._v("Company Name")])]),a("el-col",{staticClass:"mt-10",attrs:{xs:16,sm:16,md:16,lg:20,xl:20}},[a("el-input",{attrs:{type:"text",disabled:"disabled",placeholder:"Insert your company name"},model:{value:e.data.company,callback:function(t){e.$set(e.data,"company",t)},expression:"data.company"}})],1)],1),a("el-row",{attrs:{gutter:30}},[a("el-col",{attrs:{xs:8,sm:8,md:8,lg:4,xl:4}},[a("h5",[e._v("Template Name")])]),a("el-col",{staticClass:"mt-10",attrs:{xs:16,sm:16,md:16,lg:20,xl:20}},[a("el-input",{attrs:{type:"text",onkeypress:"return ((event.charCode > 64 && event.charCode < 91) || (event.charCode > 94 && event.charCode < 123) || event.charCode == 8 || event.charCode == 32 || (event.charCode >= 48 && event.charCode <= 57));",onkeyup:"this.value = this.value.toLowerCase();",placeholder:"Lowercase letters, numbers, and underscores"},nativeOn:{paste:function(t){return e.handlePaste.apply(null,arguments)},keydown:function(t){if(!t.type.indexOf("key")&&e._k(t.keyCode,"space",32,t.key,[" ","Spacebar"]))return null;t.preventDefault()}},model:{value:e.data.template_name,callback:function(t){e.$set(e.data,"template_name",t)},expression:"data.template_name"}})],1)],1),a("el-row",{attrs:{gutter:30}},[a("el-col",{attrs:{xs:8,sm:8,md:8,lg:4,xl:4}},[a("h5",[e._v("Category")])]),a("el-col",{staticClass:"mt-10",attrs:{xs:16,sm:16,md:16,lg:20,xl:20}},[[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"Select Message Type",filterable:""},model:{value:e.data.template_category,callback:function(t){e.$set(e.data,"template_category",t)},expression:"data.template_category"}},e._l(e.options_of_category,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)]],2)],1)],1),a("el-card",{staticClass:"mt-20",staticStyle:{"box-shadow":"none"}},[e._l(e.data.detail,(function(t,s){return[a("el-row",{key:s,attrs:{gutter:30}},[a("el-col",{attrs:{xs:10,sm:10,md:10,lg:7,xl:7}},[a("el-card",{attrs:{shadow:"never"}},[a("h5",[e._v("Language")]),a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"Select Language",filterable:""},model:{value:e.data.detail[s].language,callback:function(t){e.$set(e.data.detail[s],"language",t)},expression:"data.detail[i].language"}},e._l(e.options,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),a("el-col",{attrs:{xs:14,sm:14,md:14,lg:17,xl:17}},[a("el-card",{attrs:{shadow:"never"}},[a("h3",[e._v("Header (Optional)")]),a("p",{staticStyle:{"font-size":"12px"}},[e._v("Add the title or choose which type of media you'll use for this header.")]),a("el-select",{staticStyle:{width:"140px"},attrs:{placeholder:"Header Type",filterable:""},on:{change:function(t){return e.handleCangeHeader(s)}},model:{value:e.data.detail[s].header.type,callback:function(t){e.$set(e.data.detail[s].header,"type",t)},expression:"data.detail[i].header.type"}},e._l(e.header_type,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1),"text"==e.data.detail[s].header.type?a("el-input",{staticClass:"mt-10",staticStyle:{width:"100%"},attrs:{onkeydown:e.validateParamHeader(s),onkeypress:e.validateParamHeader(s),onkeyup:e.validateParamHeader(s),placeholder:"Enter text header"},model:{value:e.data.detail[s].header.data,callback:function(t){e.$set(e.data.detail[s].header,"data",t)},expression:"data.detail[i].header.data"}}):"media"==e.data.detail[s].header.type?a("div",{staticClass:"mt-10"},[a("el-radio-group",{model:{value:e.data.detail[s].header.data,callback:function(t){e.$set(e.data.detail[s].header,"data",t)},expression:"data.detail[i].header.data"}},[a("el-radio",{attrs:{label:1,border:""}},[e._v("Image")]),a("el-radio",{attrs:{label:2,border:""}},[e._v("Document")]),a("el-radio",{attrs:{label:3,border:""}},[e._v("Video")])],1)],1):e._e()],1),a("el-card",{staticClass:"mt-10",attrs:{shadow:"never"}},[a("h3",[e._v("Body")]),a("p",{staticStyle:{"font-size":"12px"}},[e._v("Enter the text for your message in the language you've selected.")]),("none"!=e.data.detail[s].header.type||e.data.detail[s].footer,a("el-input",{attrs:{onkeydown:e.validateParam(s),onkeypress:e.validateParam(s),onkeyup:e.validateParam(s),type:"textarea",maxlength:e.data.max,rows:"8",placeholder:"Insert template message request"},model:{value:e.data.detail[s].messages,callback:function(t){e.$set(e.data.detail[s],"messages",t)},expression:"data.detail[i].messages"}})),("none"!=e.data.detail[s].header.type||e.data.detail[s].footer,a("div",{domProps:{textContent:e._s(e.data.max-e.data.detail[s].messages.length)}}))],1),a("el-card",{staticClass:"mt-10",attrs:{shadow:"never"}},[a("h3",[e._v("Footer (Optional)")]),a("p",{staticStyle:{"font-size":"12px"}},[e._v("Add a short line of text to the bottom of your message template.")]),a("el-input",{attrs:{placeholder:"Enter text",maxLength:60},model:{value:e.data.detail[s].footer,callback:function(t){e.$set(e.data.detail[s],"footer",t)},expression:"data.detail[i].footer"}}),a("br"),a("span",{staticStyle:{"font-size":"12px",color:"red"}},[e._v("*Only 60 characters")])],1),a("el-card",{staticClass:"mt-10",attrs:{shadow:"never"}},[a("h3",[e._v("Buttons (Optional)")]),"none"==e.data.detail[s].buttons.type?a("p",{staticStyle:{"font-size":"12px"}},[e._v("Create buttons that let customers responds to your message or take action.")]):e._e(),"call"==e.data.detail[s].buttons.type?a("p",{staticStyle:{"font-size":"12px"}},[e._v("Create up to 2 buttons that let customers responds to your message or take action.")]):e._e(),"quick"==e.data.detail[s].buttons.type?a("p",{staticStyle:{"font-size":"12px"}},[e._v("Create up to 3 buttons that let customers responds to your message or take action.")]):e._e(),a("el-select",{staticStyle:{width:"140px"},attrs:{placeholder:"Button Type",filterable:""},model:{value:e.data.detail[s].buttons.type,callback:function(t){e.$set(e.data.detail[s].buttons,"type",t)},expression:"data.detail[i].buttons.type"}},e._l(e.buttons_type,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1),"call"==e.data.detail[s].buttons.type?a("div",{staticClass:"row mb-100 mt-10"},[a("el-row",[e._l(e.data.detail[s].action,(function(t,i){return a("el-col",{key:i,staticStyle:{padding:"5px 0"}},[a("div",{staticClass:"col-lg-3 mr-5",staticStyle:{float:"left"}},[a("p",{staticStyle:{"font-size":"12px"}},[e._v("Type of Action")]),a("el-select",{staticStyle:{width:"170px"},attrs:{size:"small",placeholder:"Button Type",filterable:""},model:{value:e.data.detail[s].action[i].type,callback:function(t){e.$set(e.data.detail[s].action[i],"type",t)},expression:"data.detail[i].action[k].type"}},0==i?e._l(e.action_type,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})):e._l(e.actfillter,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),a("div",{staticClass:"col-lg-3 mr-5",staticStyle:{float:"left"}},[a("p",{staticStyle:{"font-size":"12px"}},[e._v("Button Text")]),a("el-input",{staticStyle:{width:"90px"},attrs:{size:"small",placeholder:"Enter text"},model:{value:e.data.detail[s].action[i].text,callback:function(t){e.$set(e.data.detail[s].action[i],"text",t)},expression:"data.detail[i].action[k].text"}})],1),"call"==e.data.detail[s].action[i].type?a("div",{staticClass:"col-lg-3 mr-5",staticStyle:{float:"left"}},[a("p",{staticStyle:{"font-size":"12px"}},[e._v("Country")]),a("el-select",{staticStyle:{width:"80px"},attrs:{size:"small",placeholder:"Country code",filterable:""},model:{value:e.data.detail[s].action[i].country,callback:function(t){e.$set(e.data.detail[s].action[i],"country",t)},expression:"data.detail[i].action[k].country"}},e._l(e.country_code,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1):e._e(),"visit"==e.data.detail[s].action[i].type?a("div",{staticClass:"col-lg-3 mr-5",staticStyle:{float:"left"}},[a("p",{staticStyle:{"font-size":"12px"}},[e._v("URL Type")]),a("el-select",{staticStyle:{width:"80px"},attrs:{size:"small",placeholder:"URL Type",filterable:""},model:{value:e.data.detail[s].url[0].type,callback:function(t){e.$set(e.data.detail[s].url[0],"type",t)},expression:"data.detail[i].url[0].type"}},e._l(e.url_type,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1):e._e(),"call"==e.data.detail[s].action[i].type?a("div",{staticClass:"col-lg-3",staticStyle:{float:"left"}},[a("p",{staticStyle:{"font-size":"12px"}},[e._v("Phone Number")]),a("el-input",{staticStyle:{width:"155px"},attrs:{size:"small",placeholder:"Enter phone number"},model:{value:e.data.detail[s].action[i].phone,callback:function(t){e.$set(e.data.detail[s].action[i],"phone",t)},expression:"data.detail[i].action[k].phone"}})],1):e._e(),"visit"==e.data.detail[s].action[i].type?a("div",{staticClass:"col-lg-3 mb-20",staticStyle:{float:"left"}},[a("p",{staticStyle:{"font-size":"12px"}},[e._v("Website URL")]),"static"==e.data.detail[s].url[0].type?a("el-input",{staticClass:"mr-5",staticStyle:{width:"140px"},attrs:{size:"small",onkeydown:e.validateParamBtn(s,i),onkeypress:e.validateParamBtn(s,i),onkeyup:e.validateParamBtn(s,i),placeholder:"https://www.example.com"},model:{value:e.data.detail[s].action[i].url,callback:function(t){e.$set(e.data.detail[s].action[i],"url",t)},expression:"data.detail[i].action[k].url"}}):a("el-input",{staticClass:"mr-5",staticStyle:{width:"140px"},attrs:{size:"small",onkeydown:e.validateParamBtn(s,i),onkeypress:e.validateParamBtn(s,i),onkeyup:e.validateParamBtn(s,i),placeholder:"https://www.example.com/{{1}}"},model:{value:e.data.detail[s].action[i].url,callback:function(t){e.$set(e.data.detail[s].action[i],"url",t)},expression:"data.detail[i].action[k].url"}}),""==e.data.detail[s].action[i].url?a("el-tooltip",{attrs:{placement:"bottom-end"}},[a("div",{staticClass:"tooltip",staticStyle:{"font-size":"12px","line-height":"18px",width:"250px"},attrs:{slot:"content"},slot:"content"},[e._v(e._s("static"==e.data.detail[s].url[0].type?e.info_website_button_static:e.info_website_button_dinamic))]),a("i",{staticClass:"mdi mdi-information"})]):e._e()],1):e._e(),e.data.detail[s].action.length>1?a("span",{staticStyle:{position:"relative",top:"45px",left:"15px",cursor:"pointer"}},[a("i",{staticClass:"mdi mdi-delete",on:{click:function(t){return e.data.detail[s].action.splice(i,1)}}})]):e._e()])})),"call"==e.data.detail[s].buttons.type?a("div",{staticClass:"col-md-12 mt-10"},[a("el-button",{attrs:{size:"small mt-30",disabled:e.disabledAddCall(s)},on:{click:function(t){return e.addCallAnother(s)}}},[e._v("+ Add Another Button")])],1):e._e()],2)],1):e._e(),"quick"==e.data.detail[s].buttons.type?a("div",{staticClass:"row mt-10"},[e._l(e.data.detail[s].quick,(function(t,i){return a("div",{key:i,staticClass:"col-lg-12 mr-5"},[a("p",{staticStyle:{"font-size":"12px"}},[e._v("Button Text")]),a("el-input",{staticStyle:{width:"250px"},attrs:{size:"small",placeholder:"Enter button text"},model:{value:e.data.detail[s].quick[i].text,callback:function(t){e.$set(e.data.detail[s].quick[i],"text",t)},expression:"data.detail[i].quick[index].text"}}),e.data.detail[s].quick.length>1?a("i",{staticClass:"mdi mdi-delete ml-10",on:{click:function(t){return e.data.detail[s].quick.splice(i,1)}}}):e._e()],1)})),a("br"),a("div",{staticClass:"col-lg-12 mt-10"},[a("el-button",{attrs:{size:"small mt-10",disabled:e.disabledAddQuick(s)},on:{click:function(t){return e.addQuickAnother(s)}}},[e._v("+ Add Another Button")])],1)],2):e._e()],1),a("el-card",{staticClass:"mt-10",attrs:{shadow:"never"}},[a("el-button",{attrs:{type:"info",disabled:e.cantAddExample(s)},on:{click:function(t){return e.showModalAddSample(s)}}},[e._v("Add Sample")])],1)],1),a("div",{staticClass:"mt-20 mb-120"},["null"==e.data.detail.type?a("el-button",{staticStyle:{display:"none",float:"right"},attrs:{type:"danger"},on:{click:function(t){return e.data.detail.splice(s,1)}}},[a("i",{staticClass:"mdi mdi-delete"})]):a("el-button",{staticStyle:{float:"right","margin-top":"10px","margin-right":"1%","margin-bottom":"20px"},attrs:{type:"danger"},on:{click:function(t){return e.deleteDataTemp(s)}}},[a("i",{staticClass:"mdi mdi-delete"})])],1)],1)]})),a("el-button",{attrs:{type:"primary"},on:{click:e.clickAddLang}},[a("i",{staticClass:"mdi mdi-plus"}),e._v(" Add Language ")])],2),a("el-button",{staticClass:"mt-20",staticStyle:{float:"right"},attrs:{type:"success",loading:e.buttonLoading},on:{click:function(t){e.dialogSubmitTemplate=!0}}},[0==e.buttonLoading?a("i",{staticClass:"mdi mdi-check-circle"}):e._e(),e._v(" Submit")])],1)],1)],1),a("el-dialog",{attrs:{title:"Add Sample Content",visible:e.addSampleContentModal,"before-close":function(t){e.selectedSample={},t()}},on:{"update:visible":function(t){e.addSampleContentModal=t}}},[a("span",[e._v(" To help us understand what kind of message you want to send, you have the option to provide specific content examples for your template. You can add a sample template for one or all languages you are submitting."),a("br"),a("br"),e._v(" Make sure not to include any actual user or customer information, and provide only sample content in your examples. ")]),e.selectedSample.header&&"media"==e.selectedSample.header.type?a("div",{staticClass:"mt-20"},[1==e.data.detail[e.selectedSample.index].header.data?a("strong",[e._v("Header (image)")]):2==e.data.detail[e.selectedSample.index].header.data?a("strong",[e._v("Header (document)")]):3==e.data.detail[e.selectedSample.index].header.data?a("strong",[e._v("Header (video)")]):e._e(),a("div",{staticClass:"el-input"},[a("input",{ref:"sampleMedia",staticClass:"uploader el-input__inner",attrs:{type:"file",accept:"image/*,video/*,.pdf",id:"inputSampleMedia"},on:{change:function(t){return e.uploadMediaSample(e.selectedSample.index)}}})]),a("el-progress",{attrs:{percentage:e.uploadCsvProgress}})],1):e._e(),a("br"),e.selectedSample.header&&"text"==e.selectedSample.header.type?a("div",{staticClass:"mt-20"},[a("strong",[e._v("Header")]),a("br"),e._v(" "+e._s(e.parsingDataHeader(e.selectedSample,e.selectedSample.paramHT))+" "),a("br"),a("el-form",{staticClass:"mt-5"},e._l(e.selectedSample.paramHTcount,(function(t){return a("el-form-item",{key:t,staticClass:"mb-0"},[a("el-input",{attrs:{placeholder:"Enter content for {{"+t+"}}",type:"text"},model:{value:e.selectedSample.paramHT[t-1],callback:function(a){e.$set(e.selectedSample.paramHT,t-1,a)},expression:"selectedSample.paramHT[i-1]"}})],1)})),1)],1):e._e(),a("br"),e.selectedSample.message?a("div",{staticClass:"mb-5",staticStyle:{"white-space":"pre-line"}},[a("strong",[e._v("Body")]),e._v(" "+e._s(e.parsingData(e.selectedSample,e.selectedSample.param))+" ")]):e._e(),e.selectedSample.paramCount>0?a("el-form",e._l(e.selectedSample.paramCount,(function(t){return a("el-form-item",{key:t,staticClass:"mb-0"},[a("el-input",{attrs:{placeholder:"Enter content for {{"+t+"}}",type:"text"},model:{value:e.selectedSample.param[t-1],callback:function(a){e.$set(e.selectedSample.param,t-1,a)},expression:"selectedSample.param[i-1]"}})],1)})),1):e._e(),a("br"),e.selectedSample.button&&e.selectedSample.paramBTNcount>0?a("div",[a("strong",[e._v("Buttons")]),a("br"),e._v(" "+e._s(e.parsingDataButton(e.selectedSample,e.selectedSample.paramBTN))+" ")]):e._e(),a("br"),a("el-form",e._l(e.selectedSample.paramBTNcount,(function(t){return a("el-form-item",{key:t,staticClass:"mb-0"},[a("el-input",{attrs:{placeholder:"Enter content for {{"+t+"}}",type:"text"},model:{value:e.selectedSample.paramBTN[t-1],callback:function(a){e.$set(e.selectedSample.paramBTN,t-1,a)},expression:"selectedSample.paramBTN[i-1]"}})],1)})),1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){return e.closeModal(e.selectedSample)}}},[e._v("Cancel")]),a("el-button",{attrs:{loading:e.sampleSubmitLoad,type:"primary"},on:{click:function(t){e.addSampleContentModal=!1}}},[e._v("Confirm")])],1)],1),a("el-dialog",{attrs:{title:"Warning",visible:e.dialogSubmitTemplate,width:"30%",center:""},on:{"update:visible":function(t){e.dialogSubmitTemplate=t}}},[a("div",{staticStyle:{"text-align":"center"}},[e._v("Make sure all data is filled in correctly."),a("br"),e._v("Are you going to submit this template ?")]),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogSubmitTemplate=!1}}},[e._v("No")]),a("el-button",{attrs:{type:"primary"},on:{click:e.createTemplate}},[e._v("Yes")])],1)])],1),a("el-tab-pane",{attrs:{label:"Template List",name:"list"}},[a("el-card",{staticStyle:{"margin-bottom":"1em","box-shadow":"none"}},[a("div",{attrs:{align:"left"}},[a("el-pagination",{staticClass:"mb-20",attrs:{background:"","prev-text":"Prev","next-text":"Next",layout:"prev, pager, next","page-size":10,"current-page":e.currentPage,total:parseInt(e.totalTemp)},on:{"current-change":e.paginateTemplate}})],1),a("el-input",{staticClass:"mb-20",staticStyle:{width:"400px"},attrs:{placeholder:"Search template name",clearable:""},on:{keydown:e.doSearchTemplate,clear:e.doSearchTemplate},nativeOn:{keypress:function(t){return e.doSearchTemplate.apply(null,arguments)},keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"delete",[8,46],t.key,["Backspace","Delete","Del"])?null:e.doSearchTemplate.apply(null,arguments)}},model:{value:e.searchTemplateName,callback:function(t){e.searchTemplateName=t},expression:"searchTemplateName"}}),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loadingTable,expression:"loadingTable"}],staticStyle:{width:"100%","font-size":"12px",color:"#000 !important"},attrs:{data:e.tempList,"element-loading-text":"Loading...","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(246, 246, 245, 0.8)"}},[a("el-input",{attrs:{size:"mini",placeholder:"Type to search"},model:{value:e.searchTemplateName,callback:function(t){e.searchTemplateName=t},expression:"searchTemplateName"}}),a("el-table-column",{attrs:{fixed:"left",prop:"name",label:"Template Name",width:"300"}}),a("el-table-column",{attrs:{prop:"category",label:"Category",width:"200"}}),a("el-table-column",{attrs:{label:"Language",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.language,(function(s,i){return a("el-tag",{key:i,staticClass:"mr-5 ml-5",attrs:{type:"APPROVED"==t.row.status[i]?"success":"PENDING"==t.row.status[i]?"warning":"danger"}},["APPROVED"==t.row.status[i]?a("span",[a("el-tooltip",{attrs:{placement:"top"}},[a("div",{attrs:{slot:"content"},slot:"content"},[e._v("APPROVED")]),a("i",{staticClass:"mdi mdi-brightness-1",staticStyle:{color:"green"}})]),e._v(" "+e._s(s)+" ")],1):"REJECTED"==t.row.status[i]?a("span",[a("el-tooltip",{attrs:{placement:"top"}},[a("div",{attrs:{slot:"content"},slot:"content"},[e._v("REJECTED")]),a("i",{staticClass:"mdi mdi-brightness-1",staticStyle:{color:"red"}})]),e._v(" "+e._s(s)+" ")],1):a("span",[a("el-tooltip",{attrs:{placement:"top"}},[a("div",{attrs:{slot:"content"},slot:"content"},[e._v("PENDING")]),a("i",{staticClass:"mdi mdi-brightness-1",staticStyle:{color:"orange"}})]),e._v(" "+e._s(s)+" ")],1)])}))}}])}),a("el-table-column",{attrs:{label:"Preview",width:"370"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tooltip",[a("div",{staticClass:"tooltip",staticStyle:{"font-size":"12px","line-height":"18px",width:"250px"},attrs:{slot:"content"},slot:"content"},[e._v(e._s(t.row.message))]),a("p",{staticStyle:{"font-size":"12px"}},[e._v(e._s(t.row.message.substring(0,40))+"...")])])]}}])}),a("el-table-column",{attrs:{label:"Options",width:"150",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return["REJECTED"==t.row.status||"ERROR"==t.row.status||"PENDING"==t.row.status?a("el-button",{attrs:{type:"primary",disabled:"",size:"small"}},[e._v("Bind")]):a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(a){return e.bindingProccess(t.row)}}},[e._v("Bind")]),a("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(a){return e.deleteTemplate(t.row.name)}}},[a("i",{staticClass:"mdi mdi-delete"})])]}}])})],1),a("div",{attrs:{align:"left"}},[a("el-pagination",{staticClass:"mt-20",attrs:{background:"","prev-text":"Prev","next-text":"Next",layout:"prev, pager, next","page-size":10,"current-page":e.currentPage,total:parseInt(e.totalTemp)},on:{"current-change":e.paginateTemplate}})],1)],1),a("el-dialog",{attrs:{title:"Template Binding #"+e.selectedTemplate,visible:e.dialogBindingTemplate},on:{"update:visible":function(t){e.dialogBindingTemplate=t}}},[[a("p",[e._v("Choose phone number for assigned "),a("b",[e._v(e._s(e.selectedTemplate))]),e._v(" template")]),a("el-checkbox",{attrs:{indeterminate:e.isIndeterminate},on:{change:e.handleCheckAllChange},model:{value:e.checkAll,callback:function(t){e.checkAll=t},expression:"checkAll"}},[e._v("Check all")]),a("div",{staticStyle:{margin:"15px 0"}}),a("el-checkbox-group",{on:{change:e.handleCheckedCitiesChange},model:{value:e.checkedNumbers,callback:function(t){e.checkedNumbers=t},expression:"checkedNumbers"}},e._l(e.numbers,(function(t){return a("el-checkbox",{key:t,attrs:{label:t}},[e._v(e._s(t))])})),1)],a("el-button",{attrs:{type:"primary",size:"small",loading:e.bindLoad},on:{click:e.submitBinding}},[e._v("Submit")]),a("el-button",{staticClass:"mt-40",attrs:{type:"danger",size:"small"},on:{click:function(t){e.dialogBindingTemplate=!1}}},[e._v("Cancel")])],2)],1)],1)],1)},i=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"page-header"},[a("h1",[e._v("Whatsapp Request Template")])])}],r=a("2909"),l=(a("7f7f"),a("7514"),a("4917"),a("a481"),a("3b2b"),a("ac6a"),a("c5f6"),a("28a5"),a("6762"),a("2fdb"),a("96cf"),a("1da1")),n=a("271f"),o=a("db49"),d=a("c0d6"),c=a("7f45"),u=a.n(c),p=a("2ef0"),m=a.n(p),h=a("bc3a"),g=a("b3d5"),f=a("59a7"),b=a("cd318"),v=a("2e31"),y=a("86d9"),x=a("be6f"),w=a("6815"),_=a("f9a9"),k={data:function(){return{currentPage:1,totalTemp:0,dialogSubmitTemplate:!1,sampleSubmitLoad:!1,acceptFormat:"",exampleHeader:!1,activeTab:"request",exampleBody:!1,info_website_button_dinamic:"Adding a variable creates a personalized link for the customer to view their info. Only one variable can be added to the end of a URL. For example : https://www.example.com/{{1}}",info_website_button_static:"Adding a variable creates a personalized link for the customer to view their info. Only one variable can be added to the end of a URL. For example : https://www.example.com",counter:[1],counterHeader:[1],counterBtn:[1],bindLoad:!1,searchTemplateName:null,bindingLoading:!1,checkAll:!1,isIndeterminate:!0,checkedNumbers:[],showAlertError:!1,showFormMessage:!1,showAlertMessage:!1,buttonLoading:!1,addSampleContentModal:!1,dialogFormVisible:!1,dialogBindingTemplate:!1,dialogParamHeader:!1,dialogParamBody:!1,loadingLoadBussinessTemplate:!1,loadingBtnDeleteBussinessTemplate:!1,loadingPage:!1,loadingTable:!1,waUserDetail:{hsm:[],sender:{}},numbers:[],nonGroupList:[],selectedNumber:[],selectedTemplate:"",selectedLang:[],dataSubmit:[],selectedMessage:"",selectedId:"",message:"",checkParam:[[]],checkParamHeader:[[]],checkParamBtn:[[]],paramHeader:[],paramBody:[],paramBtn:[],data:{max:1024,max2:160,action:"insert",company:d["a"].getters.companyName,company_id:d["a"].getters.customerID,category:"",template_name:"",template_type:"BODY",template_category:"",detail:[{language:"",messages:"",body_text:[],header:{type:"none",data:null},footer:"",buttons:{type:"none"},action:[{type:"call",text:"",country:"",phone:"",url:""}],quick:[{text:""}],url:[{type:"static",link:""}]}],detailButton:{buttons:{type:"none",data:null},action:[{type:"call",text:"",country:"",phone:""}],quick:[{text:""}],url:[{type:"static",link:""}]},choose_header_type:"",text:"",media:1,header:"",footer:"",template_message:"",template_language:"",status:"PENDING"},choose_header_type:"",choose_buttons_type:"",header_type:f,buttons_type:b,action_type:v,actfillter:[],country_code:y,url_type:x,media:1,urlMedia:[],operations:{templateDialogDeleted:!1,template_selected_to_delete:""},aftercursor:null,bussinessTemplate:[{bussinessTemplate:[]}],requestTemplateList:[],bussinessTemplateList:[],tempList:[],options:g,options_of_type:_,options_of_category:w,timeout:null,sampleData:[],selectedSample:{},urlButton:[],uploadCsvProgress:0}},methods:{paginateTemplate:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(){var t,a=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=a.length>0&&void 0!==a[0]?a[0]:1,this.currentPage=t,e.next=4,this.getBussinessTemplate(this.currentPage,this.searchTemplateName);case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),deleteDataTemp:function(e){this.data.detail.splice(e,1),this.checkParam.splice(e,1),this.checkParamBtn.splice(e,1),this.checkParamHeader.splice(e,1),this.counter.splice(e,1),this.counterHeader.splice(e,1),this.counterBtn.splice(e,1)},validateParamHeader:function(e){var t=this;""!=this.data.detail[e].header.data&&(this.data.detail[e].header.data.includes("{{")&&this.data.detail[e].header.data.includes("}}")&&this.data.detail[e].header.data.lastIndexOf("}}")==this.data.detail[e].header.data.length-2?(1==this.counterHeader[e]&&0==this.data.detail[e].header.data.includes("{{".concat(this.counterHeader[e],"}}"))&&(this.data.detail[e].header.data=this.data.detail[e].header.data.split(" "),this.data.detail[e].header.data.splice(this.data.detail[e].header.data.length-1,1),this.data.detail[e].header.data=this.data.detail[e].header.data.join(" "),this.$message.error({showClose:!1,message:"First parameters must be {{1}}"})),this.data.detail[e].header.data.includes("{{".concat(this.counterHeader[e],"}}"))&&0==this.checkParamHeader[e].join(" ").includes("{{".concat(this.counterHeader[e],"}}"))?(this.checkParamHeader[e].push("{{".concat(this.counterHeader[e],"}}")),this.counterHeader[e]++):Number(this.data.detail[e].header.data.charAt(this.data.detail[e].header.data.length-3))>this.counterHeader[e]?(this.$message.error({showClose:!1,message:"Next parameters must be {{".concat(this.counterHeader[e],"}}")}),this.data.detail[e].header.data=this.data.detail[e].header.data.split(" "),this.data.detail[e].header.data.splice(this.data.detail[e].header.data.length-1,1),this.data.detail[e].header.data=this.data.detail[e].header.data.join(" ")):this.checkParamHeader[e].length>0&&this.checkParamHeader[e].forEach((function(a,s){var i=new RegExp(a.replace(/\{/g,"\\{").replace(/\}/g,"\\}"),"ig"),r=t.data.detail[e].header.data.match(i);if(r&&r.length>1){var l=t.data.detail[e].header.data.split(" ");t.$message.error({showClose:!1,message:"Parameters cannot be the same!"}),l.splice(l.length-1,1),t.checkParamHeader[e].splice(t.checkParamHeader[e].length-1,1),t.counterHeader[e]--,t.data.detail[e].header.data=l.join(" ")}}))):(0!=this.counterHeader[e]&&this.data.detail[e].header.data.includes("{{".concat(this.counterHeader[e],"}}"))&&0==this.checkParamHeader[e].join(" ").includes("{{".concat(this.counterHeader[e],"}}"))&&(this.checkParamHeader[e].push("{{".concat(this.counterHeader[e],"}}")),this.counterHeader[e]++),2==this.counterHeader[e]&&1==this.checkParamHeader[e].length&&0==this.data.detail[e].header.data.includes("{{1}}")&&(this.checkParamHeader[e]=[],this.counterHeader[e]=1)))},validateParam:function(e){var t=this;""!=this.data.detail[e].messages&&(this.data.detail[e].messages.includes("{{")&&this.data.detail[e].messages.includes("}}")&&this.data.detail[e].messages.lastIndexOf("}}")==this.data.detail[e].messages.length-2?(1==this.counter[e]&&0==this.data.detail[e].messages.includes("{{".concat(this.counter[e],"}}"))&&(this.data.detail[e].messages=this.data.detail[e].messages.split(" "),this.data.detail[e].messages.splice(this.data.detail[e].messages.length-1,1),this.data.detail[e].messages=this.data.detail[e].messages.join(" "),this.$message.error({showClose:!1,message:"First parameters must be {{1}}"})),this.data.detail[e].messages.includes("{{".concat(this.counter[e],"}}"))&&0==this.checkParam[e].join(" ").includes("{{".concat(this.counter[e],"}}"))?(this.checkParam[e].push("{{".concat(this.counter[e],"}}")),this.counter[e]++):Number(this.data.detail[e].messages.charAt(this.data.detail[e].messages.length-3))>this.counter[e]?(this.$message.error({showClose:!1,message:"Next parameters must be {{".concat(this.counter[e],"}}")}),this.data.detail[e].messages=this.data.detail[e].messages.split(" "),this.data.detail[e].messages.splice(this.data.detail[e].messages.length-1,1),this.data.detail[e].messages=this.data.detail[e].messages.join(" ")):this.checkParam[e].length>0&&this.checkParam[e].forEach((function(a,s){var i=new RegExp(a.replace(/\{/g,"\\{").replace(/\}/g,"\\}"),"ig"),r=t.data.detail[e].messages.match(i);if(r&&r.length>1){var l=t.data.detail[e].messages.split(" ");t.$message.error({showClose:!1,message:"Parameters cannot be the same!"}),l.splice(l.length-1,1),t.checkParam[e].splice(t.checkParam[e].length-1,1),t.counter[e]--,t.data.detail[e].messages=l.join(" ")}}))):(0!=this.counter[e]&&this.data.detail[e].messages.includes("{{".concat(this.counter[e],"}}"))&&0==this.checkParam[e].join(" ").includes("{{".concat(this.counter[e],"}}"))&&(this.checkParam[e].push("{{".concat(this.counter[e],"}}")),this.counter[e]++),2==this.counter[e]&&1==this.checkParam[e].length&&0==this.data.detail[e].messages.includes("{{1}}")&&(this.checkParam[e]=[],this.counter[e]=1)))},validateParamBtn:function(e,t){var a=this;if(""!=this.data.detail[e].action[t].url)if(this.data.detail[e].action[t].url.includes("{{")&&this.data.detail[e].action[t].url.includes("}}")&&this.data.detail[e].action[t].url.lastIndexOf("}}")==this.data.detail[e].action[t].url.length-2){if("static"==this.data.detail[e].url[0].type)return this.data.detail[e].action[t].url=this.data.detail[e].action[t].url.split(" "),this.data.detail[e].action[t].url.splice(this.data.detail[e].action[t].url.length-1,1),this.data.detail[e].action[t].url=this.data.detail[e].action[t].url.join(" "),void this.$message.error({showClose:!1,message:"Can't use parameter ini url static !"});1==this.counterBtn[e]&&0==this.data.detail[e].action[t].url.includes("{{".concat(this.counterBtn[e],"}}"))&&(this.data.detail[e].action[t].url=this.data.detail[e].action[t].url.split(" "),this.data.detail[e].action[t].url.splice(this.data.detail[e].action[t].url.length-1,1),this.data.detail[e].action[t].url=this.data.detail[e].action[t].url.join(" "),this.$message.error({showClose:!1,message:"First parameters must be {{1}}"})),this.data.detail[e].action[t].url.includes("{{".concat(this.counterBtn[e],"}}"))&&0==this.checkParamBtn[e].join(" ").includes("{{".concat(this.counterBtn[e],"}}"))?(this.checkParamBtn[e].push("{{".concat(this.counterBtn[e],"}}")),this.counterBtn[e]++):Number(this.data.detail[e].action[t].url.charAt(this.data.detail[e].action[t].url.length-3))>this.counterBtn[e]?(this.$message.error({showClose:!1,message:"Next parameters must be {{".concat(this.counterBtn[e],"}}")}),this.data.detail[e].action[t].url=this.data.detail[e].action[t].url.split(" "),this.data.detail[e].action[t].url.splice(this.data.detail[e].action[t].url.length-1,1),this.data.detail[e].action[t].url=this.data.detail[e].action[t].url.join(" ")):this.checkParamBtn[e].length>0&&this.checkParamBtn[e].forEach((function(s,i){var r=new RegExp(s.replace(/\{/g,"\\{").replace(/\}/g,"\\}"),"ig"),l=a.data.detail[e].action[t].url.match(r);if(l&&l.length>1){var n=a.data.detail[e].action[t].url.split(" ");a.$message.error({showClose:!1,message:"Parameters cannot be the same!"}),n.splice(n.length-1,1),a.checkParamBtn[e].splice(a.checkParamBtn[e].length-1,1),a.counterBtn[e]--,a.data.detail[e].action[t].url=n.join(" ")}}))}else 0!=this.counterBtn[e]&&this.data.detail[e].action[t].url.includes("{{".concat(this.counterBtn[e],"}}"))&&0==this.checkParamBtn[e].join(" ").includes("{{".concat(this.counterBtn[e],"}}"))&&(this.checkParamBtn[e].push("{{".concat(this.counterBtn[e],"}}")),this.counterBtn[e]++),2==this.counterBtn[e]&&1==this.checkParamBtn[e].length&&0==this.data.detail[e].action[t].url.includes("{{1}}")&&(this.checkParamBtn[e]=[],this.counterBtn[e]=1)},closeModal:function(e){this.selectedSample={},this.uploadCsvProgress=0,void 0!=this.$refs.sampleMedia&&(this.$refs.sampleMedia.value=null),this.urlMedia=[],this.addSampleContentModal=!1},showModalAddSample:function(e){var t=this.data.detail[e].messages.match(/{{\s*[\w\.]+\s*}}/g),a="media"==this.data.detail[e].header.type||"none"==this.data.detail[e].header.type?null:this.data.detail[e].header.data.match(/{{\s*[\w\.]+\s*}}/g),s=this.data.detail[e].action.find((function(e){return"visit"==e.type})),i=s?s.url.match(/{{\s*[\w\.]+\s*}}/g):"";this.sampleData[e]={message:this.data.detail[e].messages,param:[],paramHT:[],paramBTN:[],header_sample:[],header:this.data.detail[e].header,button:"call"==this.data.detail[e].buttons.type?this.data.detail[e].action:null,footer:this.data.detail[e].footer,paramCount:t?t.length:0,paramHTcount:a?a.length:0,paramBTNcount:i?i.length:0},this.sampleData.length>0&&this.urlMedia.length>0&&(this.sampleData[e].header_sample[e]=this.urlMedia[e]),this.selectedSample.index==e&&(this.sampleData[e].param=this.selectedSample.param,this.sampleData[e].paramHT=this.selectedSample.paramHT,this.sampleData[e].paramBTN=this.selectedSample.paramBTN),this.selectedSample=this.sampleData[e],this.selectedSample.index=e,this.addSampleContentModal=!0},countParam:function(e){if(this.data.detail[e].messages){var t=this.data.detail[e].messages.match(/{{\s*[\w\.]+\s*}}/g);return t?t.length:0}return 0},countParamHeaderText:function(e){if(this.data.detail[e].header.data){var t=this.data.detail[e].header.data.match(/{{\s*[\w\.]+\s*}}/g);return t?t.length:0}return 0},countParamButtonUrl:function(e){var t=this.data.detail[e].action.find((function(e){return"visit"==e.type}));if(t&&"dinamic"==this.data.detail[e].url[0].type){var a=t.url.match(/{{\s*[\w\.]+\s*}}/g);return a?a.length:0}return 0},cantAddExample:function(e){if(this.data.detail[e].messages){if(this.countParam(e)<1){var t=this.data.detail[e].action.find((function(e){return"visit"==e.type}));if("media"==this.data.detail[e].header.type)return!1;if("text"==this.data.detail[e].header.type&&""==this.data.detail[e].header.data){var a=this.data.detail[e].action.find((function(e){return"visit"==e.type}));return!((this.countParamHeaderText(e)<1||null==this.countParamHeaderText(e)||""==this.countParamHeaderText(e))&&!a)&&!(a&&this.countParamButtonUrl(e)<1)}if("text"==this.data.detail[e].header.type&&""!=this.data.detail[e].header.data){if(this.countParamHeaderText(e)>0)return!1}else if(t&&this.countParamButtonUrl(e)>0)return!1;return!0}return!1}return"none"==this.data.detail[e].header.type||("media"==this.data.detail[e].header.type?""==this.data.detail[e].header.data:"text"!=this.data.detail[e].header.type||this.countParamHeaderText(e)<1)},uploadMediaSample:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(t){var a,s,i,r,l,n=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:a=document.getElementById("inputSampleMedia"),s=a.files[0].type.split("/")[1],i=[],e.t0=this.data.detail[t].header.data,e.next=1===e.t0?6:2===e.t0?8:3===e.t0?10:12;break;case 6:return i=["jpg","jpeg"],e.abrupt("break",12);case 8:return i=["pdf"],e.abrupt("break",12);case 10:return i=["mp4","mkv","mov"],e.abrupt("break",12);case 12:if(-1!=i.indexOf(s)){e.next=18;break}return this.$refs.sampleMedia.value=null,this.$message.error({showClose:!1,message:"Media format types are not allowed, must be ( ".concat(i," ) !")}),e.abrupt("return");case 18:return r=new FormData,r.append("media",a.files[0]),r.append("type","sample_notif"),l=this,l.sampleSubmitLoad=!0,h.defaults.timeout=9e5,e.next=26,h.post(o["a"].baseApi+"upload/fbcdn",r,{headers:{"Content-Type":"multipart/form-data","api-key":this.$store.getters.accessToken},onUploadProgress:function(e){var t=parseInt(e.total/e.loaded);t=t>100?100:t,l.uploadCsvProgress=t>1?80-t:80}}).then((function(e){var a=e.data;200==a.ec?(n.urlMedia[t]=a.data.data.h,n.sampleData[t].header_sample[t]=a.data.data.h,l.uploadCsvProgress=100,l.sampleSubmitLoad=!1):n.uploadMediaSampleAlternate(t)})).catch((function(e){n.addSampleContentModal=!1,"ECONNABORTED"==e.code||"ETIMEDOUT"==e.code?n.$swal(n.$t("error"),n.$t("timeout"),"error"):n.$swal(n.$t("error"),n.$t("error_text"),"error"),l.uploadCsvProgress=0,l.sampleSubmitLoad=!1}));case 26:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),uploadMediaSampleAlternate:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(t){var a,s,i,r=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=document.getElementById("inputSampleMedia"),s=new FormData,s.append("media",a.files[0]),s.append("type","upload_media"),i=this,i.sampleSubmitLoad=!0,h.defaults.timeout=9e5,e.next=9,h.post(o["a"].baseApi+"upload/media",s,{maxContentLength:1/0,maxBodyLength:1/0,headers:{"Content-Type":"multipart/form-data"},onUploadProgress:function(e){var t=parseInt(e.total/e.loaded);t=t>100?100:t,i.uploadCsvProgress=t>1?90-t:90}}).then((function(e){200==e.data.ec?(r.urlMedia[t]=e.data.data.url,r.sampleData[t].header_sample[t]=e.data.data.url,i.uploadCsvProgress=100):(i.uploadCsvProgress=0,r.$refs.sampleMedia.value=null,r.$message.error({showClose:!1,message:"Upload file failed."})),i.sampleSubmitLoad=!1})).catch((function(e){console.log(e),r.addSampleContentModal=!1,"ECONNABORTED"==e.code||"ETIMEDOUT"==e.code?r.$swal(r.$t("error"),r.$t("timeout"),"error"):r.$swal(r.$t("error"),r.$t("error_text"),"error"),i.uploadCsvProgress=0,i.sampleSubmitLoad=!1}));case 9:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),parsingDataHeader:function(e,t){var a="",s=e.header.data.match(/{{\s*[\w\.]+\s*}}/g);return a=e.header.data,null!=s&&s.forEach((function(e,s){t[s]&&(a=a.replace(e,t[s]))})),a},parsingData:function(e,t){var a="",s=e.message.match(/{{\s*[\w\.]+\s*}}/g);return a=e.message,null!=s&&s.forEach((function(e,s){t[s]&&(a=a.replace(e,t[s]))})),a},parsingDataButton:function(e,t){var a="",s=e.button.find((function(e){return"visit"==e.type})),i=s.url.match(/{{\s*[\w\.]+\s*}}/g);return a=s.url,null!=i&&i.forEach((function(e,s){t[s]&&(a=a.replace(e,t[s]))})),a},tabClick:function(e){"list"==e.name&&(this.tempList=[],this.getBussinessTemplate(1,void 0)),this.getBussinessTemplate()},doSearchTemplate:function(){clearTimeout(this.timeout);var e=this;this.timeout=setTimeout((function(){e.tempList=[],e.getBussinessTemplate(1,e.searchTemplateName)}),1500)},addExampleHeader:function(){this.dialogParamHeader=!1},addExampleBody:function(){this.dialogParamBody=!1},addCallAnother:function(e){var t=this,a="";"call"==t.data.detail[e].action[e].type?(a="visit",t.data.detail[e].action.push({type:a,text:"",url:""})):(a="call",t.data.detail[e].action.push({type:a,phone:"",country:"",text:"",url:""}));var s=Object(r["a"])(t.action_type).filter((function(e){return e.value==a}));t.actfillter.splice(0,1,s[0])},disabledAddCall:function(e){if(this.data.detail[e].action.length<2){var t=this.data.detail[e].action.find((function(e){return"visit"==e.type?m.a.isEmpty(e.text)||m.a.isEmpty(e.url):m.a.isEmpty(e.text)||m.a.isEmpty(e.country)||m.a.isEmpty(e.phone)}));return!!t}return!0},disabledAddQuick:function(e){if(this.data.detail[e].quick.length<3){var t=this.data.detail[e].quick.find((function(e){return m.a.isEmpty(e.text)}));return!!t}return!0},addQuickAnother:function(e){var t=this;t.data.detail[e].quick.push({text:""})},bindingProccess:function(e){this.dialogBindingTemplate=!0;var t=this.nonGroupList.filter((function(t){return t.name==e.name&&"approved"==t.status.toLocaleLowerCase()}));this.selectedTemplate=t[0].name,this.dataSubmit=t.map((function(e){return{language:e.language,body:e.components.find((function(e){return"body"==e.type.toLowerCase()})).text,header:e.components.find((function(e){return"header"==e.type.toLowerCase()})),footer:e.components.find((function(e){return"footer"==e.type.toLowerCase()}))?e.components.find((function(e){return"footer"==e.type.toLowerCase()})).text:null,buttons:e.components.find((function(e){return"buttons"==e.type.toLocaleLowerCase()})),id:e.id}}))},submitBinding:function(){var e=this,t={template_name:this.selectedTemplate,list:this.dataSubmit,selected_phone:this.checkedNumbers};""!=this.checkedNumbers?(this.bindLoad=!0,Object(n["a"])({method:"post",url:"bussiness/binding-template",data:t}).then((function(t){e.$swal(e.$t("success"),"The template success to bind","success"),e.checkedNumbers=[],e.dialogBindingTemplate=!1,e.tempList=[],e.getBussinessTemplate(),e.bindLoad=!1})).catch((function(t){e.$swal(e.$t("error"),"Something when wrong","error"),e.checkedNumbers=[],e.dialogBindingTemplate=!1}))):this.$message.error({showClose:!1,message:"Please choose the numbers"})},handleCheckAllChange:function(e){this.checkedNumbers=e?this.numbers:[],this.isIndeterminate=!1},handleCheckedCitiesChange:function(e){var t=e.length;this.checkAll=t===this.numbers.length,this.isIndeterminate=t>0&&t<this.numbers.length},handlePaste:function(e){e.preventDefault();var t=window.event.clipboardData.getData("Text");this.data.template_name=this.data.template_name+t.replace(/\s/g,"_")},handleCangeHeader:function(e){this.data.detail[e].header.data=""},clickAddLang:function(){this.data.detail.push({language:"",messages:"",body_text:[],header:{type:"none",data:null},footer:"",buttons:{type:"none"},action:[{type:"call",text:"",country:"",phone:"",url:""}],quick:[{text:""}],url:[{type:"static",link:""}]}),this.checkParam.push([]),this.checkParamHeader.push([]),this.checkParamBtn.push([]),this.counter.push(1),this.counterHeader.push(1),this.counterBtn.push(1)},formatDate:function(e,t){return u()(e).format(t)},templateDialogDeleted:function(e){this.operations.templateDialogDeleted=!0,this.template_selected_to_delete=this.bussinessTemplateList[0].name},getBussinessTemplate:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(){var t,a=this,s=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=s.length>0&&void 0!==s[0]?s[0]:1,s.length>1&&void 0!==s[1]?s[1]:void 0,this.loadingTable=this.loadingPage=!0,this.currentPage=t,e.next=6,Object(n["a"])({method:"get",url:"bussiness/message-template?page="+t,params:{search:this.searchTemplateName}}).then((function(e){if(200==e.data.ec){var t=e.data.data.result;if(a.totalTemp=parseInt(e.data.data.total),a.nonGroupList.length>0?a.nonGroupList=a.nonGroupList.concat(t):(a.nonGroupList=t,a.totalTemp=parseInt(e.data.data.total)),t.length>0){var s=m.a.chain(e.data.data.result).groupBy("name").map((function(e,t){return{id:m.a.map(e,"id"),name:t,language:m.a.map(e,"language"),status:m.a.map(e,"status"),category:e[0].category,message:e[0].components.find((function(e){return"body"==e.type.toLowerCase()})).text}})).value();m.a.forEach(s,(function(e){a.tempList=s}))}}else a.showAlertError=!0})).catch((function(e){a.showAlertError=!0}));case 6:this.loadingTable=this.loadingPage=!1;case 7:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),createTemplate:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(){var t,a,s,i,r,l,o,d,c=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(this.dialogSubmitTemplate=!1,t=this.data.detail,a=Object.assign([],t),s=!1,m.a.forEach(t,(function(e,t){if(m.a.isEmpty(c.data.template_name)||m.a.isEmpty(c.data.detail[t].language)||m.a.isEmpty(c.data.template_category))return c.$message.error({showClose:!1,message:"All field is required"}),void(s=!0)})),1!=s){e.next=7;break}return e.abrupt("return");case 7:if(0!=this.sampleData.length){e.next=13;break}if(!(this.countParam(0)>0||this.countParamHeaderText(0)>0||this.countParamButtonUrl(0)>0)){e.next=11;break}return this.$message.error({showClose:!1,message:"Sample field is required"}),e.abrupt("return");case 11:e.next=42;break;case 13:if(!(this.sampleData.length>0)){e.next=42;break}i=!1,r=0;case 16:if(!(r<this.sampleData.length)){e.next=40;break}if("media"!=this.sampleData[r].header.type){e.next=22;break}if(0!=this.sampleData[r].header_sample.length){e.next=22;break}return this.$message.error({showClose:!1,message:"All Sample field is required"}),i=!0,e.abrupt("break",40);case 22:if(!(this.sampleData[r].paramCount>0)){e.next=27;break}if(this.sampleData[r].param.length==this.sampleData[r].paramCount){e.next=27;break}return this.$message.error({showClose:!1,message:"All Sample field is required"}),i=!0,e.abrupt("break",40);case 27:if(!(this.sampleData[r].paramHTcount>0)){e.next=32;break}if(this.sampleData[r].paramHT.length==this.sampleData[r].paramHTcount){e.next=32;break}return this.$message.error({showClose:!1,message:"All Sample field is required"}),i=!0,e.abrupt("break",40);case 32:if(!(this.sampleData[r].paramBTNcount>0)){e.next=37;break}if(this.sampleData[r].paramBTN.length==this.sampleData[r].paramBTNcount){e.next=37;break}return this.$message.error({showClose:!1,message:"All Sample field is required"}),i=!0,e.abrupt("break",40);case 37:r++,e.next=16;break;case 40:if(1!=i){e.next=42;break}return e.abrupt("return");case 42:for(l=!1,o=function(e){"none"==t[e].header.type&&(a[e].header.data=null),t[e].buttons.type&&("none"==t[e].buttons.type?a[e].buttons.type="none":"call"==t[e].buttons.type?m.a.forEach(t[e].action,(function(e){if("visit"==e.type){if(m.a.isEmpty(e.text)||m.a.isEmpty(e.url))return c.$message.error({showClose:!1,message:"All field is required"}),l=!0,!1}else if(m.a.isEmpty(e.phone)||m.a.isEmpty(e.text)||m.a.isEmpty(e.country))return c.$message.error({showClose:!1,message:"All field is required"}),l=!0,!1})):m.a.forEach(t[e].quick,(function(e){if(m.a.isEmpty(e.text))return c.$message.error({showClose:!1,message:"All field is required"}),l=!0,!1}))),t[e].action&&m.a.forEach(t[e].action,(function(s,i){"visit"==t[e].action[i].type?(delete a[e].action[i].phone,delete a[e].action[i].country):delete a[e].action[i].url}))},d=0;d<t.length;d++)o(d);if(1!=l){e.next=47;break}return e.abrupt("return");case 47:return this.buttonLoading=!0,e.next=50,Object(n["a"])({method:"post",url:"bussiness/message-template/create",data:{companyName:this.data.company,category:this.data.template_category,name:this.data.template_name.toLowerCase(),type:this.data.template_type,detail:a,sample:this.sampleData}}).then((function(e){var t=e.data.data;if(200!=e.data.ec&&c.$swal({type:"error",title:c.$t("error"),text:"".concat(e.data.message)}),t.length>0){var a=t.filter((function(e){if(e.status&&"error"==e.status.toLowerCase())return e}));if(0!=a.length){var s="";a.forEach((function(e){s=e.error_user_msg})),void 0==s||null==s?c.$swal({type:"error",title:c.$t("error"),text:"Something went wrong!\nMake sure you have filled in the fields correctly."}):c.$swal({type:"error",title:c.$t("error"),text:"".concat(s)})}else c.$swal(c.$t("success"),c.$t("whatsapp.createTemplate.success"),"success").then((function(){c.clear(),c.tempList=[],c.getBussinessTemplate(),c.activeTab="list",c.sampleData=[],c.selectedSample={}}))}else c.$swal(c.$t("success"),c.$t("whatsapp.createTemplate.success"),"success").then((function(){c.clear(),c.tempList=[],c.getBussinessTemplate(),c.activeTab="list",c.sampleData=[],c.selectedSample={}}))})).catch((function(e){c.$swal(c.$t("error"),c.$t("error_text"),"error")}));case 50:this.buttonLoading=!1;case 51:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),getTemplateRequest:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.loadingTable=!0,e.next=3,Object(n["a"])({method:"post",url:"whatsapp/get-request-template"}).then((function(e){200==e.data.ec?t.requestTemplateList=m.a.sortBy(e.data.data.template,(function(e){return e.Timestamp})).reverse():t.showAlertError=!0})).catch((function(e){t.showAlertError=!0}));case 3:this.loadingTable=!1;case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),clear:function(){this.nonGroupList=[],this.data.template_name="",this.data.template_category="",this.data.detail=[{language:"",messages:"",header:{type:"none",data:null},footer:"",buttons:{type:"none"},action:[{type:"call",text:"",country:"",phone:"",url:""}],quick:[{text:""}],url:[{type:"static",link:""}]}],this.message="",this.counter=[1],this.counterHeader=[1],this.counterBtn=[1],this.checkParam=[[]],this.checkParamHeader=[[]],this.checkParamBtn=[[]]},loadWa:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(n["a"])({method:"post",url:"user/detail/number",data:{channels:"whatsapp"}}).then((function(e){200==e.data.ec?(t.showFormMessage=!0,t.numbers=e.data.data):400==e.data.ec&&"not_subscribe"==e.data.message?t.showAlertMessage=!0:500==e.data.ec&&(t.showAlertError=!0)})).catch((function(e){t.showAlertError=!0,t.loadingPage=!1}));case 2:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}(),deleteTemplate:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(t){var a=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.loadingBtnDeleteBussinessTemplate=!0,this.$confirm("This will permanently delete the template. Continue?","Warning",{confirmButtonText:"OK",cancelButtonText:"Cancel",type:"warning",center:!0}).then((function(){a.loadingTable=!0,a.loadingLoadBussinessTemplate=!0,a.loadingBtnDeleteBussinessTemplate=!0,Object(n["a"])({url:o["a"].baseApi+"bussiness/message-template/delete",method:"post",data:{name:t}}).then((function(e){200!=e.data.ec?a.$message({type:"error",message:"Error"}):(a.$message({type:"success",message:"Delete completed"}),a.clear(),a.loadingTable=!1,a.dialogFormVisible=!1,a.tempList=[],a.getBussinessTemplate())})).catch((function(e){})),a.loadingBtnDeleteBussinessTemplate=!1})).catch((function(){a.$message({type:"info",message:"Delete canceled"})})),this.loadingBtnDelete=!1,this.loadingProduct=!1;case 4:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},watch:{},computed:{},mounted:function(){var e=Object(l["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.loadWa();case 2:if(!this.showFormMessage){e.next=7;break}return this.loadingPage=!0,e.next=6,this.getBussinessTemplate();case 6:this.loadingPage=!1;case 7:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},C=k,S=(a("0eaf"),a("2877")),T=Object(S["a"])(C,s,i,!1,null,"0dc453cc",null);t["default"]=T.exports},c1e1:function(e,t,a){"use strict";a("5da0")},e267:function(e,t,a){}}]);